destiny={cdn:function(){var t=document.getElementsByTagName("script"),e=t[t.length-1].src;return e.substring(0,e.indexOf("/web/js/destiny.min.js"))}(),token:"",baseUrl:"/",timeout:15e3,fn:{}},$(function(){var t=$("body"),e={height:500,width:420,scrollbars:0,toolbar:0,location:0,status:"no",menubar:0,resizable:0,dependent:0};window.getOptionsString=function(t){t=t?$.extend({},e,t):e;var n="";for(var a in t)t.hasOwnProperty(a)&&(n+=a+"="+t[a]+",");return n},$("body#bigscreen").each(function(){var t=$("#chat-panel"),e=$("#stream-panel"),n=$("iframe#chat-frame"),a=$('<div class="overlay" />');n.on("load",function(){var n=this.contentWindow;n&&$("#chat-panel-tools").each(function(){$(this).on("click","#popout",function(){return window.open("/embed/chat","_blank",window.getOptionsString()),$("body").addClass("nochat"),t.remove(),e.removeAttr("style"),!1}),$(this).on("click","#refresh",function(){return n.location.reload(),!1}),$(this).on("click","#close",function(){return $("body").addClass("nochat"),t.remove(),e.removeAttr("style"),!1})})}),$("#chat-panel-resize-bar").each(function(){var n=$(this),i=320,o=768;n.css("left",0);var r=function(a){a<i&&(a=i),e.css("width","-moz-calc(100% - "+a+"px)"),e.css("width","-webkit-calc(100% - "+a+"px)"),e.css("width","-o-calc(100% - "+a+"px)"),e.css("width","calc(100% - "+a+"px)"),t.css("width",a),n.css("left",0),localStorage["bigscreen.chat.width"]=a};n.on("mousedown.chatresize",function(e){e.preventDefault(),n.addClass("active"),a.appendTo("body");var i=e.clientX,o=n.position().left;$(document).on("mouseup.chatresize",function(e){e.preventDefault(),n.removeClass("active"),a.remove(),n.css("left",o+(e.clientX-i)),$(document).unbind("mousemove.chatresize"),$(document).unbind("mouseup.chatresize"),r(t.offset().left+t.outerWidth()-n.offset().left)}),$(document).on("mousemove.chatresize",function(t){t.preventDefault(),n.css("left",o+(t.clientX-i))})}),$(window).on("resize.chatresize",function(){$(window).width()<=o&&(e.removeAttr("style"),t.removeAttr("style"))});var s=parseInt(localStorage["bigscreen.chat.width"]);s>i&&$(window).width()>o&&r(s)})}),$(".btn-show-all").on("click",function(t){t.preventDefault(),$(".collapse").collapse("show")}),""!==location.hash&&$('a[href="'+location.hash+'"]').tab("show"),$('.navbar a[rel="'+t.attr("id")+'"]').closest("li").addClass("active"),$('.navbar a[rel="'+t.attr("class")+'"]').closest("li").addClass("active"),t.on("click","a.popup",function(t){var e=$(this);return e.data("popup",window.open(e.attr("href"),"_blank",window.getOptionsString(e.data("options")))),t.preventDefault(),!0}),$(this).find("img[data-src]").each(function(){var t=$(this),e=t.data("src");if(""!=e&&null!=e){var n=t.clone();n.one("load",function(){t.replaceWith(n)}),n.removeAttr("src").removeAttr("data-src").attr("src",e)}}),$(this).find('[data-toggle="tooltip"]').tooltip()}),function(){var t=function(t){var e=$(t),n=e.data("datetime")||e.attr("datetime")||e.text(),a=e.data("format")||"MMMM Do, h:mm:ss a";e.data("moment-fromnow")?(e.addClass("moment-update"),e.html(moment(n).fromNow())):e.data("moment-calendar")?(e.addClass("moment-update"),e.html(moment(n).calendar())):e.html(moment(n).format(a)),e.data("datetime",n).addClass("moment-set")};window.setInterval(function(){$("time.moment-update").each(function(){t(this)})},3e4),$('time[data-moment="true"]:not(.moment-set)').each(function(){t(this)})}(),function(){window.setInterval(function(){$.ajax({url:"/ping",method:"get"})},6e5)}(),function(){var t=$("#userSearchModal"),e=t.find("input#userSearchInput"),n=t.find("button#userSearchSelect"),a=t.find("form#userSearchForm"),i=t.find("textarea#giftmessage"),o=!1,r="",s=function(t,e){$.ajax({url:"/gift/check",data:{s:t},type:"GET",success:function(t){e.call(this,t)},error:function(){d("Error looking up user. Try again")}})},d=function(e){o=!0,n.button("reset").attr("disabled",!0),t.find("label.error").text(e).removeClass("hidden")},c=function(){t.modal("hide"),e.val(""),i.val(""),$("#subscriptionGiftUsername").text(""),$("#giftSubscriptionConfirm").addClass("hidden"),$("#giftSubscriptionSelect").removeClass("hidden"),$('input[name="gift"]').val(""),$('input[name="gift-message"]').val("")},l=function(t){n.button("loading"),s(t,function(e){e.valid&&e.cangift?(r=t,""==i.val()?i.focus():a.submit(),n.button("reset").attr("disabled",!1),o=!1):e.valid?e.cangift||d("This user is not eligible for a gift."):d("This user was not found. Try again.")})};e.on("keydown change",function(){n.attr("disabled",""==$(this).val()),t.find("label.error").addClass("hidden")}),a.on("submit",function(){return t.find("label.error").addClass("hidden"),r!=e.val()?l(e.val()):($("#subscriptionGiftUsername").text(e.val()),$("#giftSubscriptionConfirm").removeClass("hidden"),$("#giftSubscriptionSelect").addClass("hidden"),$('input[name="gift"]').val(e.val()),$('input[name="gift-message"]').val(i.val()),t.modal("hide")),!1}),t.on("shown.bs.modal",function(t){e.focus()}),t.on("hidden.bs.modal",function(n){o&&(o=!1,r="",e.val(""),i.val(""),t.find("label.error").addClass("hidden"))}),$("#cancelGiftSubscription").on("click",function(){return t.find("label.error").addClass("hidden"),c(),!1})}(),$(function(){$("form#addressSaveForm").validate({rules:{fullName:{required:!0},line1:{required:!0},line2:{required:!1},city:{required:!0},region:{required:!0},zip:{required:!0},country:{required:!0}},highlight:function(t){$(t).closest(".form-group").addClass("error")},unhighlight:function(t){$(t).closest(".form-group").removeClass("error")}})}),$(function(){$("#stream-status").each(function(){var t=$(this),e=t.find("#stream-status-preview > a"),n=t.find("#stream-status-end"),a=t.find("#stream-status-start"),i=t.find("#stream-status-host"),o={live:!1,game:null,preview:"",animated_preview:"",status_text:"",started_at:null,ended_at:"",duration:0,viewers:0,host:{}},r=function(o){var r=o.host&&void 0!==o.host.target_id?"hosting":o.live?"online":"offline";t.removeClass("online offline hosting").addClass(r),n.text(moment(o.ended_at).fromNow()),a.text(moment(o.started_at).fromNow()),e.data("animated",o.animated_preview).css("background-image",o.preview),"hosting"==r&&(i.text(o.host.display_name),i.attr("href",o.host.url))};setInterval(function(){$.ajax({url:"/stream.json",type:"GET"}).success(function(t){try{null!=t&&void 0!=t&&(o=$.extend(o,t),r(o))}catch(t){}})},6e4),e.src=e.css("background-image"),e.animated="url("+e.data("animated")+")",e.on("mouseover",function(){e.css("background-image",e.animated)}).on("mouseout",function(){e.css("background-image",e.src)})})}),$(function(){$("#loginForm").each(function(){var t=$(this);t.on("click","#loginFormProviders label",function(){return $(this).find('[type="radio"]').prop("checked",!0),t.trigger("submit"),!1}),t.on("keyup","#loginFormProviders label",function(e){if(13==e.keyCode)return $(this).find('[type="radio"]').prop("checked",!0),t.trigger("submit"),!1})})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRlc3RpbnkuanMiLCJ1aS5qcyJdLCJuYW1lcyI6WyJkZXN0aW55IiwiY2RuIiwic2NyaXB0cyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJzcmMiLCJsZW5ndGgiLCJzdWJzdHJpbmciLCJpbmRleE9mIiwidG9rZW4iLCJiYXNlVXJsIiwidGltZW91dCIsImZuIiwiJCIsImJvZHkiLCJwb3B1cERlZmF1bHRzIiwiaGVpZ2h0Iiwid2lkdGgiLCJzY3JvbGxiYXJzIiwidG9vbGJhciIsImxvY2F0aW9uIiwic3RhdHVzIiwibWVudWJhciIsInJlc2l6YWJsZSIsImRlcGVuZGVudCIsIndpbmRvdyIsImdldE9wdGlvbnNTdHJpbmciLCJvcHRpb25zIiwiZXh0ZW5kIiwic3RyIiwiaSIsImhhc093blByb3BlcnR5IiwiZWFjaCIsImNoYXRwYW5lbCIsInN0cmVhbXBhbmVsIiwiY2hhdGZyYW1lIiwib3ZlcmxheSIsIm9uIiwiY2hhdHdpbmRvdyIsInRoaXMiLCJjb250ZW50V2luZG93Iiwib3BlbiIsImFkZENsYXNzIiwicmVtb3ZlIiwicmVtb3ZlQXR0ciIsInJlbG9hZCIsInJlc2l6ZWJhciIsIm1pbndpZHRoIiwiZGlzYWJsZVdpZHRoIiwiY3NzIiwicmVzaXplRnJhbWVzIiwibndpZHRoIiwibG9jYWxTdG9yYWdlIiwiZSIsInByZXZlbnREZWZhdWx0IiwiYXBwZW5kVG8iLCJvZmZzZXRYIiwiY2xpZW50WCIsInN4IiwicG9zaXRpb24iLCJsZWZ0IiwicmVtb3ZlQ2xhc3MiLCJ1bmJpbmQiLCJvZmZzZXQiLCJvdXRlcldpZHRoIiwicGFyc2VJbnQiLCJjb2xsYXBzZSIsImhhc2giLCJ0YWIiLCJhdHRyIiwiY2xvc2VzdCIsImEiLCJkYXRhIiwiZmluZCIsImltZyIsInVybCIsImNsb25lIiwib25lIiwicmVwbGFjZVdpdGgiLCJ0b29sdGlwIiwiYXBwbHlNb21lbnRUb0VsZW1lbnQiLCJ1aSIsImRhdGV0aW1lIiwidGV4dCIsImZvcm1hdCIsImh0bWwiLCJtb21lbnQiLCJmcm9tTm93IiwiY2FsZW5kYXIiLCJzZXRJbnRlcnZhbCIsImFqYXgiLCJtZXRob2QiLCJ1c3JTZWFyY2giLCJ1c3JJbnB1dCIsInVzclNlbGVjdEJ0biIsInVzclNlYXJjaEZybSIsImdpZnRNc2dJbnB1dCIsImhhc0Vycm9ycyIsImdpZnRVc2VybmFtZSIsImNoZWNrVXNlciIsInVzZXJuYW1lIiwic3VjY2VzcyIsInMiLCJ0eXBlIiwiY2FsbCIsImVycm9yIiwic2hvd0xvb2t1cEVycm9yIiwibWVzc2FnZSIsImJ1dHRvbiIsImNhbmNlbFVzZXJTZWxlY3QiLCJtb2RhbCIsInZhbCIsInNlbGVjdFVzZXIiLCJyZXNwb25zZSIsInZhbGlkIiwiY2FuZ2lmdCIsImZvY3VzIiwic3VibWl0IiwidmFsaWRhdGUiLCJydWxlcyIsImZ1bGxOYW1lIiwicmVxdWlyZWQiLCJsaW5lMSIsImxpbmUyIiwiY2l0eSIsInJlZ2lvbiIsInppcCIsImNvdW50cnkiLCJoaWdobGlnaHQiLCJlbGVtZW50IiwidW5oaWdobGlnaHQiLCJlbCIsImVuZCIsInN0YXJ0IiwiaG9zdCIsImxpdmUiLCJnYW1lIiwicHJldmlldyIsImFuaW1hdGVkX3ByZXZpZXciLCJzdGF0dXNfdGV4dCIsInN0YXJ0ZWRfYXQiLCJlbmRlZF9hdCIsImR1cmF0aW9uIiwidmlld2VycyIsInVwZGF0ZVN0YXR1cyIsInN0YXRlIiwidW5kZWZpbmVkIiwiaWdub3JlZCIsImFuaW1hdGVkIiwiZm9ybSIsInByb3AiLCJ0cmlnZ2VyIiwia2V5Q29kZSJdLCJtYXBwaW5ncyI6IkFBQUFBLFNBQ0FDLElBQUEsV0FDQSxHQUFBQyxHQUFBQyxTQUFBQyxxQkFBQSxVQUNBQyxFQUFBSCxFQUFBQSxFQUFBSSxPQUFBLEdBQUFELEdBQ0EsT0FBQUEsR0FBQUUsVUFBQSxFQUFBRixFQUFBRyxRQUFBLDhCQUVBQyxNQUFBLEdBQ0FDLFFBQUEsSUFDQUMsUUFBQSxLQUNBQyxPQ1JBQyxFQUFBLFdBRUEsR0FBQUMsR0FBQUQsRUFB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LEVBQUFtRCxHQUNBd0UsRUFBQTNILElBRUEsTUFBQThILFFBRUEsS0FFQTVFLEVBQUFsRSxJQUFBa0UsRUFBQXRCLElBQUEsb0JBQ0FzQixFQUFBNkUsU0FBQSxPQUFBN0UsRUFBQUMsS0FBQSxZQUFBLElBQ0FELEVBQUFsQyxHQUFBLFlBQUEsV0FDQWtDLEVBQUF0QixJQUFBLG1CQUFBc0IsRUFBQTZFLFlBRUEvRyxHQUFBLFdBQUEsV0FDQWtDLEVBQUF0QixJQUFBLG1CQUFBc0IsRUFBQWxFLFdBT0FRLEVBQUEsV0FFQUEsRUFBQSxjQUFBbUIsS0FBQSxXQUNBLEdBQUFxSCxHQUFBeEksRUFBQTBCLEtBQ0E4RyxHQUFBaEgsR0FBQSxRQUFBLDRCQUFBLFdBR0EsTUFGQXhCLEdBQUEwQixNQUFBa0MsS0FBQSxrQkFBQTZFLEtBQUEsV0FBQSxHQUNBRCxFQUFBRSxRQUFBLFdBQ0EsSUFFQUYsRUFBQWhILEdBQUEsUUFBQSw0QkFBQSxTQUFBZ0IsR0FDQSxHQUFBLElBQUFBLEVBQUFtRyxRQUdBLE1BRkEzSSxHQUFBMEIsTUFBQWtDLEtBQUEsa0JBQUE2RSxLQUFBLFdBQUEsR0FDQUQsRUFBQUUsUUFBQSxXQUNBIiwiZmlsZSI6ImRlc3RpbnkubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZGVzdGlueSA9IHtcclxuICAgIGNkbjogKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKSxcclxuICAgICAgICAgICAgICAgIHNyYyA9IHNjcmlwdHNbc2NyaXB0cy5sZW5ndGggLSAxXS5zcmM7XHJcbiAgICAgICAgICAgIHJldHVybiBzcmMuc3Vic3RyaW5nKDAsIHNyYy5pbmRleE9mKCcvd2ViL2pzL2Rlc3RpbnkubWluLmpzJykpO1xyXG4gICAgICAgIH0pKCksXHJcbiAgICB0b2tlbjogICAgICAnJyxcclxuICAgIGJhc2VVcmw6ICAgICcvJyxcclxuICAgIHRpbWVvdXQ6ICAgIDE1MDAwLFxyXG4gICAgZm46ICAgICAgICAge31cclxufTsiLCIvLyBEb2N1bWVudCByZWFkeVxyXG4kKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgdmFyIGJvZHkgPSAkKCdib2R5Jyk7XHJcblxyXG4gICAgLy8gR2VuZXJpYyBwb3B1cCBkZWZhdWx0c1xyXG4gICAgdmFyIHBvcHVwRGVmYXVsdHMgPSB7XHJcbiAgICAgICAgaGVpZ2h0ICAgICA6NTAwLFxyXG4gICAgICAgIHdpZHRoICAgICAgOjQyMCxcclxuICAgICAgICBzY3JvbGxiYXJzIDowLFxyXG4gICAgICAgIHRvb2xiYXIgICAgOjAsXHJcbiAgICAgICAgbG9jYXRpb24gICA6MCxcclxuICAgICAgICBzdGF0dXMgICAgIDonbm8nLFxyXG4gICAgICAgIG1lbnViYXIgICAgOjAsXHJcbiAgICAgICAgcmVzaXphYmxlICA6MCxcclxuICAgICAgICBkZXBlbmRlbnQgIDowXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB3aW5kb3cuZ2V0T3B0aW9uc1N0cmluZyA9IChmdW5jdGlvbihvcHRpb25zKXtcclxuICAgICAgICBvcHRpb25zID0gKCFvcHRpb25zKSA/IHBvcHVwRGVmYXVsdHMgOiAkLmV4dGVuZCh7fSwgcG9wdXBEZWZhdWx0cywgb3B0aW9ucyk7XHJcbiAgICAgICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgICAgIGZvcih2YXIgaSBpbiBvcHRpb25zKVxyXG4gICAgICAgICAgICBpZihvcHRpb25zLmhhc093blByb3BlcnR5KGkpKVxyXG4gICAgICAgICAgICAgICAgc3RyICs9IGkgKyAnPScrIG9wdGlvbnNbaV0gKycsJztcclxuICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnYm9keSNiaWdzY3JlZW4nKS5lYWNoKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgIHZhciBjaGF0cGFuZWwgICA9ICQoJyNjaGF0LXBhbmVsJyksXHJcbiAgICAgICAgICAgIHN0cmVhbXBhbmVsID0gJCgnI3N0cmVhbS1wYW5lbCcpLFxyXG4gICAgICAgICAgICBjaGF0ZnJhbWUgICA9ICQoJ2lmcmFtZSNjaGF0LWZyYW1lJyksXHJcbiAgICAgICAgICAgIG92ZXJsYXkgICAgID0gJCgnPGRpdiBjbGFzcz1cIm92ZXJsYXlcIiAvPicpO1xyXG5cclxuICAgICAgICBjaGF0ZnJhbWUub24oJ2xvYWQnLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB2YXIgY2hhdHdpbmRvdyA9IHRoaXMuY29udGVudFdpbmRvdztcclxuXHJcbiAgICAgICAgICAgIGlmKCFjaGF0d2luZG93KVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgJCgnI2NoYXQtcGFuZWwtdG9vbHMnKS5lYWNoKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLm9uKCdjbGljaycsICcjcG9wb3V0JywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cub3BlbignL2VtYmVkL2NoYXQnLCAnX2JsYW5rJywgd2luZG93LmdldE9wdGlvbnNTdHJpbmcoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnYm9keScpLmFkZENsYXNzKCdub2NoYXQnKTtcclxuICAgICAgICAgICAgICAgICAgICBjaGF0cGFuZWwucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyZWFtcGFuZWwucmVtb3ZlQXR0cignc3R5bGUnKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICQodGhpcykub24oJ2NsaWNrJywgJyNyZWZyZXNoJywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBjaGF0d2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5vbignY2xpY2snLCAnI2Nsb3NlJywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAkKCdib2R5JykuYWRkQ2xhc3MoJ25vY2hhdCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXRwYW5lbC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBzdHJlYW1wYW5lbC5yZW1vdmVBdHRyKCdzdHlsZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gQmlnc2NyZWVuIHJlc2l6ZVxyXG4gICAgICAgICQoJyNjaGF0LXBhbmVsLXJlc2l6ZS1iYXInKS5lYWNoKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICB2YXIgcmVzaXplYmFyICAgID0gJCh0aGlzKSxcclxuICAgICAgICAgICAgICAgIG1pbndpZHRoICAgICA9IDMyMCxcclxuICAgICAgICAgICAgICAgIGRpc2FibGVXaWR0aCA9IDc2ODtcclxuXHJcbiAgICAgICAgICAgIHJlc2l6ZWJhci5jc3MoJ2xlZnQnLCAwKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlc2l6ZSB0aGUgc3RyZWFtIC8gY2hhdCBmcmFtZXNcclxuICAgICAgICAgICAgdmFyIHJlc2l6ZUZyYW1lcyA9IGZ1bmN0aW9uKG53aWR0aCkge1xyXG4gICAgICAgICAgICAgICAgaWYobndpZHRoIDwgbWlud2lkdGgpXHJcbiAgICAgICAgICAgICAgICAgICAgbndpZHRoID0gbWlud2lkdGg7XHJcbiAgICAgICAgICAgICAgICBzdHJlYW1wYW5lbC5jc3MoJ3dpZHRoJywgJy1tb3otY2FsYygxMDAlIC0gJysgbndpZHRoICsncHgpJyk7XHJcbiAgICAgICAgICAgICAgICBzdHJlYW1wYW5lbC5jc3MoJ3dpZHRoJywgJy13ZWJraXQtY2FsYygxMDAlIC0gJysgbndpZHRoICsncHgpJyk7XHJcbiAgICAgICAgICAgICAgICBzdHJlYW1wYW5lbC5jc3MoJ3dpZHRoJywgJy1vLWNhbGMoMTAwJSAtICcrIG53aWR0aCArJ3B4KScpO1xyXG4gICAgICAgICAgICAgICAgc3RyZWFtcGFuZWwuY3NzKCd3aWR0aCcsICdjYWxjKDEwMCUgLSAnKyBud2lkdGggKydweCknKTtcclxuICAgICAgICAgICAgICAgIGNoYXRwYW5lbC5jc3MoJ3dpZHRoJywgbndpZHRoKTtcclxuICAgICAgICAgICAgICAgIHJlc2l6ZWJhci5jc3MoJ2xlZnQnLCAwKTtcclxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZVsnYmlnc2NyZWVuLmNoYXQud2lkdGgnXSA9IG53aWR0aDtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHJlc2l6ZWJhci5vbignbW91c2Vkb3duLmNoYXRyZXNpemUnLCBmdW5jdGlvbihlKXtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyByZXNpemViYXIgY3NzXHJcbiAgICAgICAgICAgICAgICByZXNpemViYXIuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGRpc2FibGUgYmFja2dyb3VuZFxyXG4gICAgICAgICAgICAgICAgb3ZlcmxheS5hcHBlbmRUbygnYm9keScpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHgseSBvZiB0aGUgZHJhZyBiYXJcclxuICAgICAgICAgICAgICAgIHZhciBvZmZzZXRYID0gZS5jbGllbnRYLFxyXG4gICAgICAgICAgICAgICAgICAgIHN4ICAgICAgPSByZXNpemViYXIucG9zaXRpb24oKS5sZWZ0O1xyXG5cclxuICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZXVwLmNoYXRyZXNpemUnLCBmdW5jdGlvbihlKXtcclxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlc2l6ZWJhciBjc3NcclxuICAgICAgICAgICAgICAgICAgICByZXNpemViYXIucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBlbmFibGUgYmFja2dyb3VuZFxyXG4gICAgICAgICAgICAgICAgICAgIG92ZXJsYXkucmVtb3ZlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uIHJlc2l6ZSBiYXJcclxuICAgICAgICAgICAgICAgICAgICByZXNpemViYXIuY3NzKCdsZWZ0Jywgc3ggKyAoZS5jbGllbnRYIC0gb2Zmc2V0WCkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBubyBsb25nZXIgbmVlZCB0byBsaXN0ZW4gZm9yIGV2ZW50cyB1bnRpbCBuZXh0IG1vdXNlIGRvd25cclxuICAgICAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS51bmJpbmQoJ21vdXNlbW92ZS5jaGF0cmVzaXplJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJChkb2N1bWVudCkudW5iaW5kKCdtb3VzZXVwLmNoYXRyZXNpemUnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVzaXplIHRoZSBmcmFtZXNcclxuICAgICAgICAgICAgICAgICAgICByZXNpemVGcmFtZXMoIChjaGF0cGFuZWwub2Zmc2V0KCkubGVmdCArIGNoYXRwYW5lbC5vdXRlcldpZHRoKCkpIC0gcmVzaXplYmFyLm9mZnNldCgpLmxlZnQgKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZW1vdmUuY2hhdHJlc2l6ZScsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXNpemViYXIuY3NzKCdsZWZ0Jywgc3ggKyAoZS5jbGllbnRYIC0gb2Zmc2V0WCkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIElmIHRoZSB3aW5kb3cgaXMgcmVkdWNlZCB0byBhIHNpemUgYmVsb3cgdGhlIGRpc2FibGVXaWR0aCwgZGlzYWJsZSB0aGUgY3VzdG9tIHJlc2l6aW5nXHJcbiAgICAgICAgICAgICQod2luZG93KS5vbigncmVzaXplLmNoYXRyZXNpemUnLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgaWYoJCh3aW5kb3cpLndpZHRoKCkgPD0gZGlzYWJsZVdpZHRoKXtcclxuICAgICAgICAgICAgICAgICAgICBzdHJlYW1wYW5lbC5yZW1vdmVBdHRyKCdzdHlsZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXRwYW5lbC5yZW1vdmVBdHRyKCdzdHlsZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIE9ubG9hZCwgcmVtZW1iZXIgdGhlIGxhc3Qgd2lkdGggdGhlIHVzZXIgY2hvc2VcclxuICAgICAgICAgICAgdmFyIHdpZHRoID0gcGFyc2VJbnQobG9jYWxTdG9yYWdlWydiaWdzY3JlZW4uY2hhdC53aWR0aCddKTtcclxuICAgICAgICAgICAgaWYod2lkdGggPiBtaW53aWR0aCAmJiAkKHdpbmRvdykud2lkdGgoKSA+IGRpc2FibGVXaWR0aClcclxuICAgICAgICAgICAgICAgIHJlc2l6ZUZyYW1lcyh3aWR0aCk7XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICAgICQoJy5idG4tc2hvdy1hbGwnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgJCgnLmNvbGxhcHNlJykuY29sbGFwc2UoJ3Nob3cnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFRhYnMgc2VsZWN0b3IgLSBkb250IGtub3cgd2h5IEkgbmVlZCB0aGlzXHJcbiAgICBpZiAobG9jYXRpb24uaGFzaCAhPT0gJycpIFxyXG4gICAgICAgICQoJ2FbaHJlZj1cIicgKyBsb2NhdGlvbi5oYXNoICsgJ1wiXScpLnRhYignc2hvdycpO1xyXG5cclxuICAgIC8vIFNldCB0aGUgdG9wIG5hdiBzZWxlY3Rpb25cclxuICAgICQoJy5uYXZiYXIgYVtyZWw9XCInK2JvZHkuYXR0cignaWQnKSsnXCJdJykuY2xvc2VzdCgnbGknKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAkKCcubmF2YmFyIGFbcmVsPVwiJytib2R5LmF0dHIoJ2NsYXNzJykrJ1wiXScpLmNsb3Nlc3QoJ2xpJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgIC8vIEdlbmVyaWMgcG9wdXAgbGlua3NcclxuICAgIGJvZHkub24oJ2NsaWNrJywgJ2EucG9wdXAnLCBmdW5jdGlvbihlKXtcclxuICAgICAgICB2YXIgYSA9ICQodGhpcyk7XHJcbiAgICAgICAgYS5kYXRhKCdwb3B1cCcsIHdpbmRvdy5vcGVuKGEuYXR0cignaHJlZicpLCAnX2JsYW5rJywgd2luZG93LmdldE9wdGlvbnNTdHJpbmcoYS5kYXRhKCdvcHRpb25zJykpKSApO1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIExhenkgbG9hZCBpbWFnZXNcclxuICAgICQodGhpcykuZmluZCgnaW1nW2RhdGEtc3JjXScpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBpbWcgPSAkKHRoaXMpLCB1cmwgPSBpbWcuZGF0YSgnc3JjJyk7XHJcbiAgICAgICAgaWYgKHVybCAhPSAnJyAmJiB1cmwgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgY2xvbmUgPSBpbWcuY2xvbmUoKTtcclxuICAgICAgICAgICAgY2xvbmUub25lKCdsb2FkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaW1nLnJlcGxhY2VXaXRoKGNsb25lKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNsb25lLnJlbW92ZUF0dHIoJ3NyYycpLnJlbW92ZUF0dHIoJ2RhdGEtc3JjJykuYXR0cignc3JjJywgdXJsKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBUb29sdGlwc1xyXG4gICAgJCh0aGlzKS5maW5kKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCgpO1xyXG59KTtcclxuXHJcbi8vIENoYW5nZSB0aW1lIG9uIHNlbGVjdGVkIGVsZW1lbnRzXHJcbihmdW5jdGlvbigpe1xyXG5cclxuICAgIHZhciBhcHBseU1vbWVudFRvRWxlbWVudCA9IGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciB1aSA9ICQoZSksIFxyXG4gICAgICAgICAgICBkYXRldGltZSA9IHVpLmRhdGEoJ2RhdGV0aW1lJykgfHwgdWkuYXR0cignZGF0ZXRpbWUnKSB8fCB1aS50ZXh0KCksXHJcbiAgICAgICAgICAgIGZvcm1hdCA9IHVpLmRhdGEoJ2Zvcm1hdCcpIHx8ICdNTU1NIERvLCBoOm1tOnNzIGEnO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmKHVpLmRhdGEoJ21vbWVudC1mcm9tbm93Jykpe1xyXG4gICAgICAgICAgICB1aS5hZGRDbGFzcygnbW9tZW50LXVwZGF0ZScpO1xyXG4gICAgICAgICAgICB1aS5odG1sKG1vbWVudChkYXRldGltZSkuZnJvbU5vdygpKTtcclxuICAgICAgICB9ZWxzZSBpZih1aS5kYXRhKCdtb21lbnQtY2FsZW5kYXInKSl7XHJcbiAgICAgICAgICAgIHVpLmFkZENsYXNzKCdtb21lbnQtdXBkYXRlJyk7XHJcbiAgICAgICAgICAgIHVpLmh0bWwobW9tZW50KGRhdGV0aW1lKS5jYWxlbmRhcigpKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdWkuaHRtbChtb21lbnQoZGF0ZXRpbWUpLmZvcm1hdChmb3JtYXQpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdWkuZGF0YSgnZGF0ZXRpbWUnLCBkYXRldGltZSkuYWRkQ2xhc3MoJ21vbWVudC1zZXQnKTtcclxuICAgIH07XHJcblxyXG4gICAgd2luZG93LnNldEludGVydmFsKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgJCgndGltZS5tb21lbnQtdXBkYXRlJykuZWFjaChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBhcHBseU1vbWVudFRvRWxlbWVudCh0aGlzKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sIDMwMDAwKTtcclxuXHJcbiAgICAkKCd0aW1lW2RhdGEtbW9tZW50PVwidHJ1ZVwiXTpub3QoLm1vbWVudC1zZXQpJykuZWFjaChmdW5jdGlvbigpe1xyXG4gICAgICAgIGFwcGx5TW9tZW50VG9FbGVtZW50KHRoaXMpO1xyXG4gICAgfSk7XHJcblxyXG59KSgpO1xyXG5cclxuXHJcbi8vUGluZ1xyXG4oZnVuY3Rpb24oKXtcclxuICAgIHdpbmRvdy5zZXRJbnRlcnZhbChmdW5jdGlvbigpe1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9waW5nJyxcclxuICAgICAgICAgICAgbWV0aG9kOiAnZ2V0J1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSwgMTAqNjAqMTAwMCk7XHJcbn0pKCk7XHJcblxyXG5cclxuLy8gR2lmdGluZyAvIHVzZXIgc2VhcmNoXHJcbihmdW5jdGlvbigpe1xyXG5cclxuICAgIHZhciB1c3JTZWFyY2ggICAgPSAkKCcjdXNlclNlYXJjaE1vZGFsJyksXHJcbiAgICAgICAgdXNySW5wdXQgICAgID0gdXNyU2VhcmNoLmZpbmQoJ2lucHV0I3VzZXJTZWFyY2hJbnB1dCcpLFxyXG4gICAgICAgIHVzclNlbGVjdEJ0biA9IHVzclNlYXJjaC5maW5kKCdidXR0b24jdXNlclNlYXJjaFNlbGVjdCcpLFxyXG4gICAgICAgIHVzclNlYXJjaEZybSA9IHVzclNlYXJjaC5maW5kKCdmb3JtI3VzZXJTZWFyY2hGb3JtJyksXHJcbiAgICAgICAgZ2lmdE1zZ0lucHV0ID0gdXNyU2VhcmNoLmZpbmQoJ3RleHRhcmVhI2dpZnRtZXNzYWdlJyksXHJcbiAgICAgICAgaGFzRXJyb3JzICAgID0gZmFsc2UsXHJcbiAgICAgICAgZ2lmdFVzZXJuYW1lID0gJyc7XHJcblxyXG4gICAgdmFyIGNoZWNrVXNlciA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBzdWNjZXNzKXtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvZ2lmdC9jaGVjaycsXHJcbiAgICAgICAgICAgIGRhdGE6IHtzOiB1c2VybmFtZX0sXHJcbiAgICAgICAgICAgIHR5cGU6ICdHRVQnLFxyXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3MuY2FsbCh0aGlzLCBkYXRhKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBzaG93TG9va3VwRXJyb3IoJ0Vycm9yIGxvb2tpbmcgdXAgdXNlci4gVHJ5IGFnYWluJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBzaG93TG9va3VwRXJyb3IgPSBmdW5jdGlvbihtZXNzYWdlKXtcclxuICAgICAgICBoYXNFcnJvcnMgPSB0cnVlO1xyXG4gICAgICAgIHVzclNlbGVjdEJ0bi5idXR0b24oJ3Jlc2V0JykuYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcclxuICAgICAgICB1c3JTZWFyY2guZmluZCgnbGFiZWwuZXJyb3InKS50ZXh0KG1lc3NhZ2UpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGNhbmNlbFVzZXJTZWxlY3QgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIHVzclNlYXJjaC5tb2RhbCgnaGlkZScpO1xyXG4gICAgICAgIHVzcklucHV0LnZhbCgnJyk7XHJcbiAgICAgICAgZ2lmdE1zZ0lucHV0LnZhbCgnJyk7XHJcbiAgICAgICAgJCgnI3N1YnNjcmlwdGlvbkdpZnRVc2VybmFtZScpLnRleHQoJycpO1xyXG4gICAgICAgICQoJyNnaWZ0U3Vic2NyaXB0aW9uQ29uZmlybScpLmFkZENsYXNzKCdoaWRkZW4nKTtcclxuICAgICAgICAkKCcjZ2lmdFN1YnNjcmlwdGlvblNlbGVjdCcpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcclxuICAgICAgICAkKCdpbnB1dFtuYW1lPVwiZ2lmdFwiXScpLnZhbCgnJyk7XHJcbiAgICAgICAgJCgnaW5wdXRbbmFtZT1cImdpZnQtbWVzc2FnZVwiXScpLnZhbCgnJyk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBzZWxlY3RVc2VyID0gZnVuY3Rpb24odXNlcm5hbWUpe1xyXG4gICAgICAgIHVzclNlbGVjdEJ0bi5idXR0b24oJ2xvYWRpbmcnKTtcclxuICAgICAgICBjaGVja1VzZXIodXNlcm5hbWUsIGZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgICAgICAgaWYocmVzcG9uc2UudmFsaWQgJiYgcmVzcG9uc2UuY2FuZ2lmdCl7XHJcbiAgICAgICAgICAgICAgICBnaWZ0VXNlcm5hbWUgPSB1c2VybmFtZTtcclxuICAgICAgICAgICAgICAgIGlmKGdpZnRNc2dJbnB1dC52YWwoKSA9PSAnJylcclxuICAgICAgICAgICAgICAgICAgICBnaWZ0TXNnSW5wdXQuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICB1c3JTZWFyY2hGcm0uc3VibWl0KCk7XHJcbiAgICAgICAgICAgICAgICB1c3JTZWxlY3RCdG4uYnV0dG9uKCdyZXNldCcpLmF0dHIoJ2Rpc2FibGVkJywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgaGFzRXJyb3JzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1lbHNlIGlmKCFyZXNwb25zZS52YWxpZCl7XHJcbiAgICAgICAgICAgICAgICBzaG93TG9va3VwRXJyb3IoJ1RoaXMgdXNlciB3YXMgbm90IGZvdW5kLiBUcnkgYWdhaW4uJyk7XHJcbiAgICAgICAgICAgIH1lbHNlIGlmKCFyZXNwb25zZS5jYW5naWZ0KXtcclxuICAgICAgICAgICAgICAgIHNob3dMb29rdXBFcnJvcignVGhpcyB1c2VyIGlzIG5vdCBlbGlnaWJsZSBmb3IgYSBnaWZ0LicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHVzcklucHV0Lm9uKCdrZXlkb3duIGNoYW5nZScsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdXNyU2VsZWN0QnRuLmF0dHIoJ2Rpc2FibGVkJywgJCh0aGlzKS52YWwoKSA9PSAnJyk7XHJcbiAgICAgICAgdXNyU2VhcmNoLmZpbmQoJ2xhYmVsLmVycm9yJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdXNyU2VhcmNoRnJtLm9uKCdzdWJtaXQnLCBmdW5jdGlvbigpe1xyXG4gICAgICAgIHVzclNlYXJjaC5maW5kKCdsYWJlbC5lcnJvcicpLmFkZENsYXNzKCdoaWRkZW4nKTtcclxuICAgICAgICBpZihnaWZ0VXNlcm5hbWUgIT0gdXNySW5wdXQudmFsKCkpIHtcclxuICAgICAgICAgICAgc2VsZWN0VXNlcih1c3JJbnB1dC52YWwoKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCgnI3N1YnNjcmlwdGlvbkdpZnRVc2VybmFtZScpLnRleHQodXNySW5wdXQudmFsKCkpO1xyXG4gICAgICAgICAgICAkKCcjZ2lmdFN1YnNjcmlwdGlvbkNvbmZpcm0nKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XHJcbiAgICAgICAgICAgICQoJyNnaWZ0U3Vic2NyaXB0aW9uU2VsZWN0JykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xyXG4gICAgICAgICAgICAkKCdpbnB1dFtuYW1lPVwiZ2lmdFwiXScpLnZhbCh1c3JJbnB1dC52YWwoKSk7XHJcbiAgICAgICAgICAgICQoJ2lucHV0W25hbWU9XCJnaWZ0LW1lc3NhZ2VcIl0nKS52YWwoZ2lmdE1zZ0lucHV0LnZhbCgpKTtcclxuICAgICAgICAgICAgdXNyU2VhcmNoLm1vZGFsKCdoaWRlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHVzclNlYXJjaC5vbignc2hvd24uYnMubW9kYWwnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHVzcklucHV0LmZvY3VzKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB1c3JTZWFyY2gub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgaWYoaGFzRXJyb3JzKXtcclxuICAgICAgICAgICAgaGFzRXJyb3JzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGdpZnRVc2VybmFtZSA9ICcnO1xyXG4gICAgICAgICAgICB1c3JJbnB1dC52YWwoJycpO1xyXG4gICAgICAgICAgICBnaWZ0TXNnSW5wdXQudmFsKCcnKTtcclxuICAgICAgICAgICAgdXNyU2VhcmNoLmZpbmQoJ2xhYmVsLmVycm9yJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNjYW5jZWxHaWZ0U3Vic2NyaXB0aW9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcclxuICAgICAgICB1c3JTZWFyY2guZmluZCgnbGFiZWwuZXJyb3InKS5hZGRDbGFzcygnaGlkZGVuJyk7XHJcbiAgICAgICAgY2FuY2VsVXNlclNlbGVjdCgpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxufSkoKTtcclxuXHJcbiQoZnVuY3Rpb24oKXtcclxuICAgICQoJ2Zvcm0jYWRkcmVzc1NhdmVGb3JtJykudmFsaWRhdGUoe1xyXG4gICAgICAgIHJ1bGVzOiB7XHJcbiAgICAgICAgICAgIGZ1bGxOYW1lIDogeyByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICBsaW5lMSAgICA6IHsgcmVxdWlyZWQ6IHRydWUgfSxcclxuICAgICAgICAgICAgbGluZTIgICAgOiB7IHJlcXVpcmVkOiBmYWxzZSB9LFxyXG4gICAgICAgICAgICBjaXR5ICAgICA6IHsgcmVxdWlyZWQ6IHRydWUgfSxcclxuICAgICAgICAgICAgcmVnaW9uICAgOiB7IHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHppcCAgICAgIDogeyByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICBjb3VudHJ5ICA6IHsgcmVxdWlyZWQ6IHRydWUgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaGlnaGxpZ2h0OiBmdW5jdGlvbihlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICQoZWxlbWVudCkuY2xvc2VzdCgnLmZvcm0tZ3JvdXAnKS5hZGRDbGFzcygnZXJyb3InKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHVuaGlnaGxpZ2h0OiBmdW5jdGlvbihlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICQoZWxlbWVudCkuY2xvc2VzdCgnLmZvcm0tZ3JvdXAnKS5yZW1vdmVDbGFzcygnZXJyb3InKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG4kKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJCgnI3N0cmVhbS1zdGF0dXMnKS5lYWNoKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGVsID0gJCh0aGlzKSxcclxuICAgICAgICAgICAgYSA9IGVsLmZpbmQoJyNzdHJlYW0tc3RhdHVzLXByZXZpZXcgPiBhJyksXHJcbiAgICAgICAgICAgIGVuZCA9IGVsLmZpbmQoJyNzdHJlYW0tc3RhdHVzLWVuZCcpLFxyXG4gICAgICAgICAgICBzdGFydCA9IGVsLmZpbmQoJyNzdHJlYW0tc3RhdHVzLXN0YXJ0JyksXHJcbiAgICAgICAgICAgIGhvc3QgPSBlbC5maW5kKCcjc3RyZWFtLXN0YXR1cy1ob3N0Jyk7XHJcblxyXG4gICAgICAgIHZhciBzdGF0dXMgPSB7XHJcbiAgICAgICAgICAgIGxpdmU6IGZhbHNlLFxyXG4gICAgICAgICAgICBnYW1lOiBudWxsLFxyXG4gICAgICAgICAgICBwcmV2aWV3OiBcIlwiLFxyXG4gICAgICAgICAgICBhbmltYXRlZF9wcmV2aWV3OiBcIlwiLFxyXG4gICAgICAgICAgICBzdGF0dXNfdGV4dDogXCJcIixcclxuICAgICAgICAgICAgc3RhcnRlZF9hdDogbnVsbCxcclxuICAgICAgICAgICAgZW5kZWRfYXQ6IFwiXCIsXHJcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLFxyXG4gICAgICAgICAgICB2aWV3ZXJzOiAwLFxyXG4gICAgICAgICAgICBob3N0OiB7fVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciB1cGRhdGVTdGF0dXMgPSBmdW5jdGlvbihzdGF0dXMpe1xyXG4gICAgICAgICAgICB2YXIgc3RhdGUgPSAoc3RhdHVzWydob3N0J10gJiYgc3RhdHVzLmhvc3RbJ3RhcmdldF9pZCddICE9PSB1bmRlZmluZWQpID8gJ2hvc3RpbmcnIDogKHN0YXR1cy5saXZlID8gJ29ubGluZSc6J29mZmxpbmUnKTtcclxuICAgICAgICAgICAgZWwucmVtb3ZlQ2xhc3MoJ29ubGluZSBvZmZsaW5lIGhvc3RpbmcnKS5hZGRDbGFzcyhzdGF0ZSk7XHJcbiAgICAgICAgICAgIGVuZC50ZXh0KG1vbWVudChzdGF0dXMuZW5kZWRfYXQpLmZyb21Ob3coKSk7XHJcbiAgICAgICAgICAgIHN0YXJ0LnRleHQobW9tZW50KHN0YXR1cy5zdGFydGVkX2F0KS5mcm9tTm93KCkpO1xyXG4gICAgICAgICAgICBhLmRhdGEoJ2FuaW1hdGVkJywgc3RhdHVzLmFuaW1hdGVkX3ByZXZpZXcpLmNzcygnYmFja2dyb3VuZC1pbWFnZScsIHN0YXR1cy5wcmV2aWV3KTtcclxuICAgICAgICAgICAgaWYoc3RhdGUgPT0gJ2hvc3RpbmcnKXtcclxuICAgICAgICAgICAgICAgIGhvc3QudGV4dChzdGF0dXMuaG9zdFsnZGlzcGxheV9uYW1lJ10pO1xyXG4gICAgICAgICAgICAgICAgaG9zdC5hdHRyKCdocmVmJywgc3RhdHVzLmhvc3RbJ3VybCddKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvc3RyZWFtLmpzb24nLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ0dFVCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGRhdGEgIT0gbnVsbCAmJiBkYXRhICE9IHVuZGVmaW5lZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9ICQuZXh0ZW5kKHN0YXR1cywgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVN0YXR1cyhzdGF0dXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gY2F0Y2goaWdub3JlZCl7fVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LCA2MDAwMCk7XHJcblxyXG4gICAgICAgIGEuc3JjID0gYS5jc3MoJ2JhY2tncm91bmQtaW1hZ2UnKTtcclxuICAgICAgICBhLmFuaW1hdGVkID0gICd1cmwoJysgYS5kYXRhKCdhbmltYXRlZCcpICsnKSc7XHJcbiAgICAgICAgYS5vbignbW91c2VvdmVyJywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgYS5jc3MoJ2JhY2tncm91bmQtaW1hZ2UnLCBhLmFuaW1hdGVkKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbignbW91c2VvdXQnLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBhLmNzcygnYmFja2dyb3VuZC1pbWFnZScsIGEuc3JjKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxufSk7XHJcblxyXG5cclxuJChmdW5jdGlvbigpe1xyXG5cclxuICAgICQoJyNsb2dpbkZvcm0nKS5lYWNoKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGZvcm0gPSAkKHRoaXMpO1xyXG4gICAgICAgIGZvcm0ub24oJ2NsaWNrJywgJyNsb2dpbkZvcm1Qcm92aWRlcnMgbGFiZWwnLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAkKHRoaXMpLmZpbmQoJ1t0eXBlPVwicmFkaW9cIl0nKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGZvcm0udHJpZ2dlcignc3VibWl0Jyk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBmb3JtLm9uKCdrZXl1cCcsICcjbG9naW5Gb3JtUHJvdmlkZXJzIGxhYmVsJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT0gMTMpe1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKCdbdHlwZT1cInJhZGlvXCJdJykucHJvcCgnY2hlY2tlZCcsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgZm9ybS50cmlnZ2VyKCdzdWJtaXQnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG59KTsiXX0=
