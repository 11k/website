webpackJsonp([1],{115:function(e,t){function s(){return(new Date).getTime()}e.exports=Date.now||s},132:function(e,t){e.exports=["NORTHWESTERNMUTUAL","TRAVELERSINSURANCE","AMERICANEXPRESS","KERRYPROPERTIES","SANDVIKCOROMANT","AFAMILYCOMPANY","AMERICANFAMILY","BANANAREPUBLIC","CANCERRESEARCH","COOKINGCHANNEL","KERRYLOGISTICS","WEATHERCHANNEL","INTERNATIONAL","LIFEINSURANCE","SPREADBETTING","TRAVELCHANNEL","WOLTERSKLUWER","CONSTRUCTION","LPLFINANCIAL","PAMPEREDCHEF","SCHOLARSHIPS","VERSICHERUNG","ACCOUNTANTS","BARCLAYCARD","BLACKFRIDAY","BLOCKBUSTER","BRIDGESTONE","CALVINKLEIN","CONTRACTORS","CREDITUNION","ENGINEERING","ENTERPRISES","FOODNETWORK","INVESTMENTS","KERRYHOTELS","LAMBORGHINI","MOTORCYCLES","OLAYANGROUP","PHOTOGRAPHY","PLAYSTATION","PRODUCTIONS","PROGRESSIVE","REDUMBRELLA","RIGHTATHOME","WILLIAMHILL","ACCOUNTANT","APARTMENTS","ASSOCIATES","BASKETBALL","BNPPARIBAS","BOEHRINGER","CAPITALONE","CONSULTING","CREDITCARD","CUISINELLA","EUROVISION","EXTRASPACE","FOUNDATION","HEALTHCARE","IMMOBILIEN","INDUSTRIES","MANAGEMENT","MITSUBISHI","NATIONWIDE","NEWHOLLAND","NEXTDIRECT","ONYOURSIDE","PROPERTIES","PROTECTION","PRUDENTIAL","REALESTATE","REPUBLICAN","RESTAURANT","SCHAEFFLER","SWIFTCOVER","TATAMOTORS","TECHNOLOGY","TELEFONICA","UNIVERSITY","VISTAPRINT","VLAANDEREN","VOLKSWAGEN","ACCENTURE","ALFAROMEO","ALLFINANZ","AMSTERDAM","ANALYTICS","AQUARELLE","BARCELONA","BLOOMBERG","CHRISTMAS","COMMUNITY","DIRECTORY","EDUCATION","EQUIPMENT","FAIRWINDS","FINANCIAL","FIRESTONE","FRESENIUS","FRONTDOOR","FUJIXEROX","FURNITURE","GOLDPOINT","GOODHANDS","HISAMITSU","HOMEDEPOT","HOMEGOODS","HOMESENSE","HONEYWELL","INSTITUTE","INSURANCE","KUOKGROUP","LADBROKES","LANCASTER","LANDROVER","LIFESTYLE","MARKETING","MARSHALLS","MCDONALDS","MELBOURNE","MICROSOFT","MONTBLANC","PANASONIC","PASSAGENS","PRAMERICA","RICHARDLI","SCJOHNSON","SHANGRILA","SOLUTIONS","STATEBANK","STATEFARM","STOCKHOLM","TRAVELERS","VACATIONS","YODOBASHI","ABUDHABI","AIRFORCE","ALLSTATE","ATTORNEY","BARCLAYS","BAREFOOT","BARGAINS","BASEBALL","BOUTIQUE","BRADESCO","BROADWAY","BRUSSELS","BUDAPEST","BUILDERS","BUSINESS","CAPETOWN","CATERING","CATHOLIC","CHRYSLER","CIPRIANI","CITYEATS","CLEANING","CLINIQUE","CLOTHING","COMMBANK","COMPUTER","DELIVERY","DELOITTE","DEMOCRAT","DIAMONDS","DISCOUNT","DISCOVER","DOWNLOAD","ENGINEER","ERICSSON","ESURANCE","EVERBANK","EXCHANGE","FEEDBACK","FIDELITY","FIRMDALE","FOOTBALL","FRONTIER","GOODYEAR","GRAINGER","GRAPHICS","GUARDIAN","HDFCBANK","HELSINKI","HOLDINGS","HOSPITAL","INFINITI","IPIRANGA","ISTANBUL","JPMORGAN","LIGHTING","LUNDBECK","MARRIOTT","MASERATI","MCKINSEY","MEMORIAL","MORTGAGE","MOVISTAR","OBSERVER","PARTNERS","PHARMACY","PICTURES","PLUMBING","PROPERTY","REDSTONE","RELIANCE","SAARLAND","SAMSCLUB","SECURITY","SERVICES","SHOPPING","SHOWTIME","SOFTBANK","SOFTWARE","STCGROUP","SUPPLIES","SYMANTEC","TELECITY","TRAINING","UCONNECT","VANGUARD","VENTURES","VERISIGN","WOODSIDE","YOKOHAMA","ABOGADO","ACADEMY","AGAKHAN","ALIBABA","ANDROID","ATHLETA","AUCTION","AUDIBLE","AUSPOST","AVIANCA","BANAMEX","BAUHAUS","BENTLEY","BESTBUY","BOOKING","BROTHER","BUGATTI","CAPITAL","CARAVAN","CAREERS","CARTIER","CHANNEL","CHINTAI","CITADEL","CLUBMED","COLLEGE","COLOGNE","COMCAST","COMPANY","COMPARE","CONTACT","COOKING","CORSICA","COUNTRY","COUPONS","COURSES","CRICKET","CRUISES","DENTIST","DIGITAL","DOMAINS","EXPOSED","EXPRESS","FARMERS","FASHION","FERRARI","FERRERO","FINANCE","FISHING","FITNESS","FLIGHTS","FLORIST","FLOWERS","FORSALE","FROGANS","FUJITSU","GALLERY","GENTING","GODADDY","GUITARS","HAMBURG","HANGOUT","HITACHI","HOLIDAY","HOSTING","HOTELES","HOTMAIL","HYUNDAI","ISELECT","ISMAILI","JEWELRY","JUNIPER","KITCHEN","KOMATSU","LACAIXA","LANCOME","LANXESS","LASALLE","LATROBE","LECLERC","LIAISON","LIMITED","LINCOLN","MARKETS","METLIFE","MONSTER","NETBANK","NETFLIX","NETWORK","NEUSTAR","OKINAWA","OLDNAVY","ORGANIC","ORIGINS","PANERAI","PHILIPS","PIONEER","POLITIE","REALTOR","RECIPES","RENTALS","REVIEWS","REXROTH","SAMSUNG","SANDVIK","SCHMIDT","SCHWARZ","SCIENCE","SHIKSHA","SHRIRAM","SINGLES","SPIEGEL","STAPLES","STARHUB","STATOIL","STORAGE","SUPPORT","SURGERY","SYSTEMS","TEMASEK","THEATER","THEATRE","TICKETS","TIFFANY","TOSHIBA","TRADING","WALMART","WANGGOU","WATCHES","WEATHER","WEBSITE","WEDDING","WHOSWHO","WINDOWS","WINNERS","XFINITY","YAMAXUN","YOUTUBE","ZUERICH","ABARTH","ABBOTT","ABBVIE","ACTIVE","AFRICA","AGENCY","AIRBUS","AIRTEL","ALIPAY","ALSACE","ALSTOM","ANQUAN","ARAMCO","AUTHOR","BAYERN","BEAUTY","BERLIN","BHARTI","BLANCO","BOSTIK","BOSTON","BROKER","CAMERA","CAREER","CASEIH","CASINO","CENTER","CHANEL","CHROME","CHURCH","CIRCLE","CLAIMS","CLINIC","COFFEE","COMSEC","CONDOS","COUPON","CREDIT","CRUISE","DATING","DATSUN","DEALER","DEGREE","DENTAL","DESIGN","DIRECT","DOCTOR","DUNLOP","DUPONT","DURBAN","EMERCK","ENERGY","ESTATE","EVENTS","EXPERT","FAMILY","FLICKR","FUTBOL","GALLUP","GARDEN","GEORGE","GIVING","GLOBAL","GOOGLE","GRATIS","HEALTH","HERMES","HIPHOP","HOCKEY","HOTELS","HUGHES","IMAMAT","INSURE","INTUIT","JAGUAR","JOBURG","JUEGOS","KAUFEN","KINDER","KINDLE","KOSHER","LANCIA","LATINO","LAWYER","LEFRAK","LIVING","LOCKER","LONDON","LUXURY","MADRID","MAISON","MAKEUP","MARKET","MATTEL","MOBILE","MOBILY","MONASH","MORMON","MOSCOW","MUSEUM","MUTUAL","NAGOYA","NATURA","NISSAN","NISSAY","NORTON","NOWRUZ","OFFICE","OLAYAN","ONLINE","ORACLE","ORANGE","OTSUKA","PFIZER","PHOTOS","PHYSIO","PIAGET","PICTET","QUEBEC","RACING","REALTY","REISEN","REPAIR","REPORT","REVIEW","ROCHER","ROGERS","RYUKYU","SAFETY","SAKURA","SANOFI","SCHOOL","SCHULE","SECURE","SELECT","SHOUJI","SOCCER","SOCIAL","STREAM","STUDIO","SUPPLY","SUZUKI","SWATCH","SYDNEY","TAIPEI","TAOBAO","TARGET","TATTOO","TENNIS","TIENDA","TJMAXX","TKMAXX","TOYOTA","TRAVEL","UNICOM","VIAJES","VIKING","VILLAS","VIRGIN","VISION","VOTING","VOYAGE","VUELOS","WALTER","WARMAN","WEBCAM","XIHUAN","XPERIA","YACHTS","YANDEX","ZAPPOS","ACTOR","ADULT","AETNA","AMFAM","AMICA","APPLE","ARCHI","AUDIO","AUTOS","AZURE","BAIDU","BEATS","BIBLE","BINGO","BLACK","BOATS","BOOTS","BOSCH","BUILD","CANON","CARDS","CHASE","CHEAP","CHLOE","CISCO","CITIC","CLICK","CLOUD","COACH","CODES","CROWN","CYMRU","DABUR","DANCE","DEALS","DELTA","DODGE","DRIVE","DUBAI","EARTH","EDEKA","EMAIL","EPOST","EPSON","FAITH","FEDEX","FINAL","FOREX","FORUM","GALLO","GAMES","GIFTS","GIVES","GLADE","GLASS","GLOBO","GMAIL","GREEN","GRIPE","GROUP","GUCCI","GUIDE","HOMES","HONDA","HORSE","HOUSE","HYATT","IKANO","INTEL","IRISH","IVECO","JETZT","KOELN","KYOTO","LAMER","LEASE","LEGAL","LEXUS","LILLY","LINDE","LIPSY","LIXIL","LOANS","LOCUS","LOTTE","LOTTO","LUPIN","MACYS","MANGO","MEDIA","MIAMI","MONEY","MOPAR","MOVIE","NADEX","NEXUS","NIKON","NINJA","NOKIA","NOWTV","OMEGA","OSAKA","PARIS","PARTS","PARTY","PHONE","PHOTO","PIZZA","PLACE","POKER","PRAXI","PRESS","PRIME","PROMO","QUEST","RADIO","REHAB","REISE","RICOH","ROCKS","RODEO","RUGBY","SALON","SENER","SEVEN","SHARP","SHELL","SHOES","SKYPE","SLING","SMART","SMILE","SOLAR","SPACE","STADA","STORE","STUDY","STYLE","SUCKS","SWISS","TATAR","TIRES","TIROL","TMALL","TODAY","TOKYO","TOOLS","TORAY","TOTAL","TOURS","TRADE","TRUST","TUNES","TUSHU","UBANK","VEGAS","VIDEO","VISTA","VODKA","VOLVO","WALES","WATCH","WEBER","WEIBO","WORKS","WORLD","XEROX","YAHOO","ZIPPO","local","onion","AARP","ABLE","ADAC","AERO","AIGO","AKDN","ALLY","AMEX","ARAB","ARMY","ARPA","ARTE","ASDA","ASIA","AUDI","AUTO","BABY","BAND","BANK","BBVA","BEER","BEST","BIKE","BING","BLOG","BLUE","BOFA","BOND","BOOK","BUZZ","CAFE","CALL","CAMP","CARE","CARS","CASA","CASE","CASH","CBRE","CERN","CHAT","CITI","CITY","CLUB","COOL","COOP","CYOU","DATA","DATE","DCLK","DEAL","DELL","DESI","DIET","DISH","DOCS","DOHA","DUCK","DUNS","DVAG","ERNI","FAGE","FAIL","FANS","FARM","FAST","FIAT","FIDO","FILM","FIRE","FISH","FLIR","FOOD","FORD","FREE","FUND","GAME","GBIZ","GENT","GGEE","GIFT","GMBH","GOLD","GOLF","GOOG","GUGE","GURU","HAIR","HAUS","HDFC","HELP","HERE","HGTV","HOST","HSBC","ICBC","IEEE","IMDB","IMMO","INFO","ITAU","JAVA","JEEP","JOBS","JPRS","KDDI","KIWI","KPMG","KRED","LAND","LEGO","LGBT","LIDL","LIFE","LIKE","LIMO","LINK","LIVE","LOAN","LOFT","LOVE","LTDA","LUXE","MAIF","MEET","MEME","MENU","MINI","MINT","MOBI","MODA","MOTO","NAME","NAVY","NEWS","NEXT","NICO","NIKE","OLLO","OPEN","PAGE","PARS","PCCW","PICS","PING","PINK","PLAY","PLUS","POHL","PORN","POST","PROD","PROF","QPON","RAID","READ","REIT","RENT","REST","RICH","RMIT","ROOM","RSVP","RUHR","SAFE","SALE","SAPO","SARL","SAVE","SAXO","SCOR","SCOT","SEAT","SEEK","SEXY","SHAW","SHIA","SHOP","SHOW","SILK","SINA","SITE","SKIN","SNCF","SOHU","SONG","SONY","SPOT","STAR","SURF","TALK","TAXI","TEAM","TECH","TEVA","TIAA","TIPS","TOWN","TOYS","TUBE","VANA","VISA","VIVA","VIVO","VOTE","VOTO","WANG","WEIR","WIEN","WIKI","WINE","WORK","XBOX","YOGA","ZARA","ZERO","ZONE","exit","zkey","AAA","ABB","ABC","ACO","ADS","AEG","AFL","AIG","ANZ","AOL","APP","ART","AWS","AXA","BAR","BBC","BBT","BCG","BCN","BET","BID","BIO","BIZ","BMS","BMW","BNL","BOM","BOO","BOT","BOX","BUY","BZH","CAB","CAL","CAM","CAR","CAT","CBA","CBN","CBS","CEB","CEO","CFA","CFD","COM","CRS","CSC","DAD","DAY","DDS","DEV","DHL","DIY","DNP","DOG","DOT","DTV","DVR","EAT","ECO","EDU","ESQ","EUS","FAN","FIT","FLY","FOO","FOX","FRL","FTR","FUN","FYI","GAL","GAP","GDN","GEA","GLE","GMO","GMX","GOO","GOP","GOT","GOV","HBO","HIV","HKT","HOT","HOW","HTC","IBM","ICE","ICU","IFM","ING","INK","INT","IST","ITV","IWC","JCB","JCP","JIO","JLC","JLL","JMP","JNJ","JOT","JOY","KFH","KIA","KIM","KPN","KRD","LAT","LAW","LDS","LOL","LPL","LTD","MAN","MBA","MCD","MED","MEN","MEO","MIL","MIT","MLB","MLS","MMA","MOE","MOI","MOM","MOV","MSD","MTN","MTR","NAB","NBA","NEC","NET","NEW","NFL","NGO","NHK","NOW","NRA","NRW","NTT","NYC","OBI","OFF","ONE","ONG","ONL","OOO","ORG","OTT","OVH","PAY","PET","PID","PIN","PNC","PRO","PRU","PUB","PWC","QVC","RED","REN","RIL","RIO","RIP","RUN","RWE","SAP","SAS","SBI","SBS","SCA","SCB","SES","SEW","SEX","SFR","SKI","SKY","SOY","SRL","SRT","STC","TAB","TAX","TCI","TDK","TEL","THD","TJX","TOP","TRV","TUI","TVS","UBS","UNO","UOL","UPS","VET","VIG","VIN","VIP","WED","WIN","WME","WOW","WTC","WTF","XIN","XXX","XYZ","YOU","YUN","ZIP","bit","gnu","i2p","AC","AD","AE","AF","AG","AI","AL","AM","AO","AQ","AR","AS","AT","AU","AW","AX","AZ","BA","BB","BD","BE","BF","BG","BH","BI","BJ","BM","BN","BO","BR","BS","BT","BV","BW","BY","BZ","CA","CC","CD","CF","CG","CH","CI","CK","CL","CM","CN","CO","CR","CU","CV","CW","CX","CY","CZ","DE","DJ","DK","DM","DO","DZ","EC","EE","EG","ER","ES","ET","EU","FI","FJ","FK","FM","FO","FR","GA","GB","GD","GE","GF","GG","GH","GI","GL","GM","GN","GP","GQ","GR","GS","GT","GU","GW","GY","HK","HM","HN","HR","HT","HU","ID","IE","IL","IM","IN","IO","IQ","IR","IS","IT","JE","JM","JO","JP","KE","KG","KH","KI","KM","KN","KP","KR","KW","KY","KZ","LA","LB","LC","LI","LK","LR","LS","LT","LU","LV","LY","MA","MC","MD","ME","MG","MH","MK","ML","MM","MN","MO","MP","MQ","MR","MS","MT","MU","MV","MW","MX","MY","MZ","NA","NC","NE","NF","NG","NI","NL","NO","NP","NR","NU","NZ","OM","PA","PE","PF","PG","PH","PK","PL","PM","PN","PR","PS","PT","PW","PY","QA","RE","RO","RS","RU","RW","SA","SB","SC","SD","SE","SG","SH","SI","SJ","SK","SL","SM","SN","SO","SR","ST","SU","SV","SX","SY","SZ","TC","TD","TF","TG","TH","TJ","TK","TL","TM","TN","TO","TR","TT","TV","TW","TZ","UA","UG","UK","US","UY","UZ","VA","VC","VE","VG","VI","VN","VU","WF","WS","YE","YT","ZA","ZM","ZW"]},133:function(e,t,s){var i,n;/*! nanoScrollerJS - v0.8.7 - 2015
* http://jamesflorentino.github.com/nanoScrollerJS/
* Copyright (c) 2015 James Florentino; Licensed MIT */
!function(u){i=[s(4)],void 0!==(n=function(e){return u(e,window,document)}.apply(t,i))&&(e.exports=n)}(function(e,t,s){"use strict";var i,n,u,r,o,a,l,h,c,d,f,g,A,p,E,m,S,v,C,O,T,I,N,M,B,R,y,F;O={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},E="scroll",l="mousedown",h="mouseenter",c="mousemove",f="mousewheel",d="mouseup",p="resize",o="drag",a="enter",S="up",A="panedown",u="DOMMouseScroll",r="down",v="wheel",m="touchmove",i="Microsoft Internet Explorer"===t.navigator.appName&&/msie 7./i.test(t.navigator.appVersion)&&t.ActiveXObject,n=null,M=t.requestAnimationFrame,C=t.cancelAnimationFrame,R=s.createElement("div").style,F=function(){var e,t,s,i;for(t=["t","webkitT","MozT","msT","OT"],e=s=0,i=t.length;s<i;e=++s)if(t[e],t[e]+"ransform"in R)return t[e].substr(0,t[e].length-1);return!1}(),y=function(e){return!1!==F&&(""===F?e:F+e.charAt(0).toUpperCase()+e.substr(1))},B=y("transform"),I=!1!==B,T=function(){var e,t,i;return e=s.createElement("div"),t=e.style,t.position="absolute",t.width="100px",t.height="100px",t.overflow=E,t.top="-9999px",s.body.appendChild(e),i=e.offsetWidth-e.clientWidth,s.body.removeChild(e),i},N=function(){var e,s,i;return s=t.navigator.userAgent,!!(e=/(?=.+Mac OS X)(?=.+Firefox)/.test(s))&&(i=/Firefox\/\d{2}\./.exec(s),i&&(i=i[0].replace(/\D+/g,"")),e&&+i>23)},g=function(){function g(i,u){this.el=i,this.options=u,n||(n=T()),this.$el=e(this.el),this.doc=e(this.options.documentContext||s),this.win=e(this.options.windowContext||t),this.body=this.doc.find("body"),this.$content=this.$el.children("."+this.options.contentClass),this.$content.attr("tabindex",this.options.tabIndex||0),this.content=this.$content[0],this.previousPosition=0,this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return g.prototype.preventScrolling=function(e,t){if(this.isActive)if(e.type===u)(t===r&&e.originalEvent.detail>0||t===S&&e.originalEvent.detail<0)&&e.preventDefault();else if(e.type===f){if(!e.originalEvent||!e.originalEvent.wheelDelta)return;(t===r&&e.originalEvent.wheelDelta<0||t===S&&e.originalEvent.wheelDelta>0)&&e.preventDefault()}},g.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},g.prototype.updateScrollValues=function(){var e,t;e=this.content,this.maxScrollTop=e.scrollHeight-e.clientHeight,this.prevScrollTop=this.contentScrollTop||0,this.contentScrollTop=e.scrollTop,t=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same",this.previousPosition=this.contentScrollTop,"same"!==t&&this.$el.trigger("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:t}),this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=0===this.maxScrollTop?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},g.prototype.setOnScrollStyles=function(){var e;I?(e={},e[B]="translate(0, "+this.sliderTop+"px)"):e={top:this.sliderTop},M?(C&&this.scrollRAF&&C(this.scrollRAF),this.scrollRAF=M(function(t){return function(){return t.scrollRAF=null,t.slider.css(e)}}(this))):this.slider.css(e)},g.prototype.createEvents=function(){this.events={down:function(e){return function(t){return e.isBeingDragged=!0,e.offsetY=t.pageY-e.slider.offset().top,e.slider.is(t.target)||(e.offsetY=0),e.pane.addClass("active"),e.doc.bind(c,e.events[o]).bind(d,e.events[S]),e.body.bind(h,e.events[a]),!1}}(this),drag:function(e){return function(t){return e.sliderY=t.pageY-e.$el.offset().top-e.paneTop-(e.offsetY||.5*e.sliderHeight),e.scroll(),e.contentScrollTop>=e.maxScrollTop&&e.prevScrollTop!==e.maxScrollTop?e.$el.trigger("scrollend"):0===e.contentScrollTop&&0!==e.prevScrollTop&&e.$el.trigger("scrolltop"),!1}}(this),up:function(e){return function(t){return e.isBeingDragged=!1,e.pane.removeClass("active"),e.doc.unbind(c,e.events[o]).unbind(d,e.events[S]),e.body.unbind(h,e.events[a]),!1}}(this),resize:function(e){return function(t){e.reset()}}(this),panedown:function(e){return function(t){return e.sliderY=(t.offsetY||t.originalEvent.layerY)-.5*e.sliderHeight,e.scroll(),e.events.down(t),!1}}(this),scroll:function(e){return function(t){e.updateScrollValues(),e.isBeingDragged||(e.iOSNativeScrolling||(e.sliderY=e.sliderTop,e.setOnScrollStyles()),null!=t&&(e.contentScrollTop>=e.maxScrollTop?(e.options.preventPageScrolling&&e.preventScrolling(t,r),e.prevScrollTop!==e.maxScrollTop&&e.$el.trigger("scrollend")):0===e.contentScrollTop&&(e.options.preventPageScrolling&&e.preventScrolling(t,S),0!==e.prevScrollTop&&e.$el.trigger("scrolltop"))))}}(this),wheel:function(e){return function(t){var s;if(null!=t)return s=t.delta||t.wheelDelta||t.originalEvent&&t.originalEvent.wheelDelta||-t.detail||t.originalEvent&&-t.originalEvent.detail,s&&(e.sliderY+=-s/3),e.scroll(),!1}}(this),enter:function(e){return function(t){var s;if(e.isBeingDragged)return 1!==(t.buttons||t.which)?(s=e.events)[S].apply(s,arguments):void 0}}(this)}},g.prototype.addEvents=function(){var e;this.removeEvents(),e=this.events,this.options.disableResize||this.win.bind(p,e[p]),this.iOSNativeScrolling||(this.slider.bind(l,e[r]),this.pane.bind(l,e[A]).bind(f+" "+u,e[v])),this.$content.bind(E+" "+f+" "+u+" "+m,e[E])},g.prototype.removeEvents=function(){var e;e=this.events,this.win.unbind(p,e[p]),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(E+" "+f+" "+u+" "+m,e[E])},g.prototype.generate=function(){var e,s,i,u,r,o;return i=this.options,r=i.paneClass,o=i.sliderClass,i.contentClass,(u=this.$el.children("."+r)).length||u.children("."+o).length||this.$el.append('<div class="'+r+'"><div class="'+o+'" /></div>'),this.pane=this.$el.children("."+r),this.slider=this.pane.find("."+o),0===n&&N()?(s=t.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/[^0-9.]+/g,""),e={right:-14,paddingRight:+s+14}):n&&(e={right:-n},this.$el.addClass("has-scrollbar")),null!=e&&this.$content.css(e),this},g.prototype.restore=function(){this.stopped=!1,this.iOSNativeScrolling||this.pane.show(),this.addEvents()},g.prototype.reset=function(){var e,t,s,u,r,o,a,l,h,c,d,f;return this.iOSNativeScrolling?void(this.contentHeight=this.content.scrollHeight):(this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),e=this.content,u=e.style,r=u.overflowY,i&&this.$content.css({height:this.$content.height()}),t=e.scrollHeight+n,c=parseInt(this.$el.css("max-height"),10),c>0&&(this.$el.height(""),this.$el.height(e.scrollHeight>c?c:e.scrollHeight)),a=this.pane.outerHeight(!1),h=parseInt(this.pane.css("top"),10),o=parseInt(this.pane.css("bottom"),10),l=a+h+o,f=Math.round(l/t*a),f<this.options.sliderMinHeight?f=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&f>this.options.sliderMaxHeight&&(f=this.options.sliderMaxHeight),r===E&&u.overflowX!==E&&(f+=n),this.maxSliderTop=l-f,this.contentHeight=t,this.paneHeight=a,this.paneOuterHeight=l,this.sliderHeight=f,this.paneTop=h,this.slider.height(f),this.events.scroll(),this.pane.show(),this.isActive=!0,e.scrollHeight===e.clientHeight||this.pane.outerHeight(!0)>=e.scrollHeight&&r!==E?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===e.scrollHeight&&r===E?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),s=this.$content.css("position"),"static"!==s&&"relative"!==s||(d=parseInt(this.$content.css("right"),10))&&this.$content.css({right:"",marginRight:d}),this)},g.prototype.scroll=function(){if(this.isActive)return this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop(this.maxScrollTop*this.sliderY/this.maxSliderTop),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this},g.prototype.scrollBottom=function(e){if(this.isActive)return this.$content.scrollTop(this.contentHeight-this.$content.height()-e).trigger(f),this.stop().restore(),this},g.prototype.scrollTop=function(e){if(this.isActive)return this.$content.scrollTop(+e).trigger(f),this.stop().restore(),this},g.prototype.scrollTo=function(e){if(this.isActive)return this.scrollTop(this.$el.find(e).get(0).offsetTop),this},g.prototype.stop=function(){return C&&this.scrollRAF&&(C(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},g.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),i&&this.$content.height(""),this.$content.removeAttr("tabindex"),this.$el.hasClass("has-scrollbar")&&(this.$el.removeClass("has-scrollbar"),this.$content.css({right:""})),this},g.prototype.flash=function(){if(!this.iOSNativeScrolling&&this.isActive)return this.reset(),this.pane.addClass("flashed"),setTimeout(function(e){return function(){e.pane.removeClass("flashed")}}(this),this.options.flashDelay),this},g}(),e.fn.nanoScroller=function(t){return this.each(function(){var s,i;if((i=this.nanoscroller)||(s=e.extend({},O,t),this.nanoscroller=i=new g(this,s)),t&&"object"==typeof t){if(e.extend(i.options,t),null!=t.scrollBottom)return i.scrollBottom(t.scrollBottom);if(null!=t.scrollTop)return i.scrollTop(t.scrollTop);if(t.scrollTo)return i.scrollTo(t.scrollTo);if("bottom"===t.scroll)return i.scrollBottom(0);if("top"===t.scroll)return i.scrollTop(0);if(t.scroll&&t.scroll instanceof e)return i.scrollTo(t.scroll);if(t.stop)return i.stop();if(t.destroy)return i.destroy();if(t.flash)return i.flash()}return i.reset()})},e.fn.nanoScroller.Constructor=g})},29:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={PROTECTED:"protected",SUBSCRIBER:"subscriber",SUBSCRIBERT0:"flair9",SUBSCRIBERT1:"flair13",SUBSCRIBERT2:"flair1",SUBSCRIBERT3:"flair3",SUBSCRIBERT4:"flair8",VIP:"vip",MODERATOR:"moderator",ADMIN:"admin",BROADCASTER:"flair12",BOT:"bot",BOT2:"flair11",NOTABLE:"flair2",TRUSTED:"flair4",CONTRIBUTOR:"flair5",COMPCHALLENGE:"flair6",EVE:"flair7",SC2:"flair10"}},306:function(e,t){},313:function(e,t,s){"use strict";s(27),s(25),s(28),s(26),s(70),s(306);var i=s(51).default,n=s(74),u="ws"+("https:"===window.location.protocol?"s":"")+"://"+window.location.host+"/ws";(new i).withEmotes(n).withFormatters().withGui().connect(u)},42:function(e,t,s){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),u=function(){function e(){i(this,e),this.listeners=new Map}return n(e,[{key:"on",value:function(e,t){return this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t),this}},{key:"emit",value:function(e){for(var t=arguments.length,s=Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];var n=this.listeners.get(e);return!(!n||!n.length)&&(n.forEach(function(e){return e.apply(void 0,s)}),!0)}}]),e}();t.default=u},51:function(e,t,s){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function n(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),a=s(67),l=i(a),h=s(0),c=i(h),d=s(42),f=i(d),g=s(91),A=i(g),p=s(92),E=i(p),m=s(90),S=s(89),v=s(87),C=s(85),O=i(C),T=s(88),I=i(T),N=s(62),M=i(N),B=s(86),R=i(B),y=s(63),F=i(y),w=s(29),D=i(w),L=/^[a-zA-Z0-9_]{3,20}$/,b=["green","yellow","orange","red","purple","blue","sky","lime","pink","black"],k=new Map([["unknown","Unknown error, this usually indicates an internal problem :("],["nopermission","You do not have the required permissions to use that"],["protocolerror","Invalid or badly formatted"],["needlogin","You have to be logged in to use that"],["invalidmsg","The message was invalid"],["throttled","Throttled! You were trying to send messages too fast"],["duplicate","The message is identical to the last one you sent"],["muted","You are muted (subscribing auto-removes mutes). Check your profile for more information."],["submode","The channel is currently in subscriber only mode"],["needbanreason","Providing a reason for the ban is mandatory"],["banned","You have been banned (subscribing auto-removes non-permanent bans), disconnecting. Check your profile for more information."],["requiresocket","This chat requires WebSockets"],["toomanyconnections","Only 5 concurrent connections allowed"],["socketerror","Error contacting server"],["privmsgbanned","Cannot send private messages while banned"],["privmsgaccounttooyoung","Your account is too recent to send private messages"],["notfound","The user was not found"],["notconnected","You have to be connected to use that"]]),U=new Map([["slashhelp","Type in /help for more a list of commands, do advanced things like modify your scroll-back size"],["tabcompletion","Use the tab key to auto-complete usernames and emotes (for user only completion prepend a @ or press shift)"],["hoveremotes","Hovering your mouse over an emote will show you the emote code"],["highlight","Chat messages containing your username will be highlighted"],["notify","Use /msg <username> to send a private message to someone"],["ignoreuser","Use /ignore <username> to hide messages from pesky chatters"],["mutespermanent","Mutes are never persistent, don't worry it will pass!"],["stalkmentionshint","Use the /stalk <nick> or /mentions <nick> to keep up to date"],["tagshint","Use the /tag <nick> <color> to highlight users you like. There are preset colors to choose from "+b.join(", ")]]),P=new Map([["showtime",!1],["hideflairicons",!1],["profilesettings",!1],["timestampformat","HH:mm"],["maxlines",250],["allowNotifications",!1],["highlight",!0],["customhighlight",[]],["highlightnicks",[]],["taggednicks",[]],["showremoved",!1],["showhispersinchat",!1],["ignorenicks",[]]]),H=new Map([["help",""],["emotes",""],["me",""],["msg",""],["ignore","without arguments to list the nicks ignored"],["unignore",""],["highlight","highlights target nicks messages for easier visibility"],["unhighlight",""],["maxlines",""],["mute",""],["unmute",""],["subonly",""],["ban",""],["unban","also unbans ip bans"],["timestampformat",""],["stalk",""],["mentions",""],["tag",""],["untag",""]]),G=function(){function t(){var s=this;u(this,t),this.uri="",this.ui=e("#chat"),this.css=e("#chat-styles")[0].sheet,this.output=this.ui.find("#chat-output"),this.lines=this.ui.find("#chat-lines"),this.input=this.ui.find("#chat-input-control"),this.scrollnotify=this.ui.find("#chat-scroll-notify"),this.loginscrn=this.ui.find("#chat-login-screen"),this.loadingscrn=this.ui.find("#chat-loading"),this.control=new f.default(this),this.source=new A.default,this.user=new E.default,this.users=new Map,this.whispers=new Map,this.reconnect=!0,this.connected=!1,this.lastmessage=null,this.unresolved=[],this.formatters=[],this.emoticons=new Set,this.twitchemotes=new Set,this.ignoreregex=null,this.showstarthint=!0,this.authenticated=!0,this.backlogloading=!1,this.autocomplete=new O.default(this),this.settings=new Map([].concat(n(P))),this.taggednicks=new Map,this.ignoring=new Set,this.source.on("PING",function(e){return s.source.send("PONG",e)}),this.source.on("OPEN",function(e){return s.connected=!0}),this.source.on("REFRESH",function(e){return window.location.reload(!1)}),this.source.on("CONNECTING",function(e){return s.onCONNECTING(e)}),this.source.on("DISPATCH",function(e){return s.onDISPATCH(e)}),this.source.on("CLOSE",function(e){return s.onCLOSE(e)}),this.source.on("NAMES",function(e){return s.onNAMES(e)}),this.source.on("JOIN",function(e){return s.onJOIN(e)}),this.source.on("QUIT",function(e){return s.onQUIT(e)}),this.source.on("MSG",function(e){return s.onMSG(e)}),this.source.on("MUTE",function(e){return s.onMUTE(e)}),this.source.on("UNMUTE",function(e){return s.onUNMUTE(e)}),this.source.on("BAN",function(e){return s.onBAN(e)}),this.source.on("UNBAN",function(e){return s.onUNBAN(e)}),this.source.on("ERR",function(e){return s.onERR(e)}),this.source.on("SUBONLY",function(e){return s.onSUBONLY(e)}),this.source.on("BROADCAST",function(e){return s.onBROADCAST(e)}),this.control.on("SEND",function(e){return s.cmdSEND(e)}),this.control.on("HINT",function(e){return s.cmdHINT(e)}),this.control.on("EMOTES",function(e){return s.cmdEMOTES(e)}),this.control.on("HELP",function(e){return s.cmdHELP(e)}),this.control.on("IGNORE",function(e){return s.cmdIGNORE(e)}),this.control.on("UNIGNORE",function(e){return s.cmdUNIGNORE(e)}),this.control.on("MUTE",function(e){return s.cmdMUTE(e)}),this.control.on("BAN",function(e){return s.cmdBAN(e,"BAN")}),this.control.on("IPBAN",function(e){return s.cmdBAN(e,"IPBAN")}),this.control.on("UNMUTE",function(e){return s.cmdUNBAN(e,"UNMUTE")}),this.control.on("UNBAN",function(e){return s.cmdUNBAN(e,"UNBAN")}),this.control.on("UNBAN",function(e){return s.cmdUNBAN(e,"UNBAN")}),this.control.on("SUBONLY",function(e){return s.cmdSUBONLY(e,"SUBONLY")}),this.control.on("MAXLINES",function(e){return s.cmdMAXLINES(e,"MAXLINES")}),this.control.on("UNHIGHLIGHT",function(e){return s.cmdTOGGLEHIGHLIGHT(e,"UNHIGHLIGHT")}),this.control.on("HIGHLIGHT",function(e){return s.cmdTOGGLEHIGHLIGHT(e,"HIGHLIGHT")}),this.control.on("TIMESTAMPFORMAT",function(e){return s.cmdTIMESTAMPFORMAT(e)}),this.control.on("BROADCAST",function(e){return s.cmdBROADCAST(e)}),this.control.on("CONNECT",function(e){return s.cmdCONNECT(e)}),this.control.on("TAG",function(e){return s.cmdTAG(e)}),this.control.on("UNTAG",function(e){return s.cmdUNTAG(e)}),this.source.on("PRIVMSGSENT",function(e){return s.onPRIVMSGSENT(e)}),this.source.on("PRIVMSG",function(e){return s.onPRIVMSG(e)}),this.control.on("MESSAGE",function(e){return s.cmdWHISPER(e)}),this.control.on("MSG",function(e){return s.cmdWHISPER(e)}),this.control.on("WHISPER",function(e){return s.cmdWHISPER(e)}),this.control.on("W",function(e){return s.cmdWHISPER(e)}),this.control.on("TELL",function(e){return s.cmdWHISPER(e)}),this.control.on("T",function(e){return s.cmdWHISPER(e)}),this.control.on("NOTIFY",function(e){return s.cmdWHISPER(e)}),this.control.on("MENTIONS",function(e){return s.cmdMENTIONS(e)}),this.control.on("M",function(e){return s.cmdMENTIONS(e)}),this.control.on("STALK",function(e){return s.cmdSTALK(e)}),this.control.on("S",function(e){return s.cmdSTALK(e)})}return o(t,[{key:"withUserAndSettings",value:function(e){return this.withUser(e).withSettings(e&&e.hasOwnProperty("settings")?e.settings:[])}},{key:"withUser",value:function(e){return this.user=this.addUser(e||{}),this.authenticated=null!==this.user&&""!==this.user.username,this}},{key:"withSettings",value:function(e){var t=this;this.authenticated&&new Map([].concat(n(e))).get("profilesettings")?this.settings=new Map([].concat(n(P),n(e))):this.settings=new Map([].concat(n(P),n(F.default.read("chat.settings")||[]),[["profilesettings",!1]]));var s=!1,i=F.default.read("chatoptions");return i&&(s=!0,Object.keys(i).forEach(function(e){switch(e){case"highlightnicks":t.settings.set("highlightnicks",Object.keys(i[e]));break;default:t.settings.set(e,i[e])}})),i=F.default.read("chatignorelist"),i&&(s=!0,this.settings.set("ignorenicks",Object.keys(i)||[])),i=F.default.read("chat.ignoring"),i&&(s=!0,this.settings.set("ignorenicks",i)),i=F.default.read("inputhistory"),i&&F.default.write("chat.history",i),i=null,F.default.remove("chatoptions"),F.default.remove("inputhistory"),F.default.remove("chatignorelist"),F.default.remove("hiddenhints"),F.default.remove("lasthinttime"),F.default.remove("unreadMessageCount"),F.default.remove("chat.shownhints"),F.default.remove("chat.ignoring"),s&&this.saveSettings(),this}},{key:"withGui",value:function(){var t=this;[].concat(n(H.entries())).forEach(function(e){return t.autocomplete.addToBucket("/"+e[0],1,!1,0)}),this.taggednicks=new Map(this.settings.get("taggednicks")),this.ignoring=new Set(this.settings.get("ignorenicks")),this.scrollplugin=new M.default(this.output),this.inputhistory=new I.default(this),this.userfocus=new R.default(this,this.css),this.menus=new Map([["settings",new S.ChatSettingsMenu(this.ui.find("#chat-settings"),this.ui.find("#chat-settings-btn"),this)],["emotes",new S.ChatEmoteMenu(this.ui.find("#chat-emote-list"),this.ui.find("#chat-emoticon-btn"),this)],["users",new S.ChatUserMenu(this.ui.find("#chat-user-list"),this.ui.find("#chat-users-btn"),this)],["whisper-users",new S.ChatWhisperUsers(this.ui.find("#chat-whisper-users"),this.ui.find("#chat-whisper-btn"),this)],["whisper-messages",new S.ChatWhisperMessages(this.ui.find("#chat-whisper-messages"),e.fn,this)]]),this.applySettings(!1),this.loadingscrn.fadeOut(),this.input.on("keypress",function(e){13!==e.keyCode||e.shiftKey||e.ctrlKey||(e.preventDefault(),e.stopPropagation(),t.authenticated?(t.control.emit("SEND",t.input.val().toString().trim()),t.input.val("").focus()):(t.loginscrn.show(),t.input.blur()))}),this.lines.on("click",".censored .ctrl",function(t){return e(t.target).closest(".censored").removeClass("censored"),!1}),this.output.on("update",(0,l.default)(function(){return t.scrollnotify.toggle(!t.scrollplugin.isPinned())},100)),this.scrollnotify.on("mousedown",function(){return!1}),this.scrollnotify.on("mouseup",function(){return t.scrollplugin.updateAndPin(!0),!1}),this.mousedown=!1,this.waspinned=!0,this.waitingtopin=!1;var s=(0,l.default)(function(){t.waspinned&&!t.mousedown&&t.scrollplugin.updateAndPin(!0),t.waitingtopin=!1},750);this.output.on("mouseup",function(){t.mousedown=!1,t.waitingtopin=!0,s()}),this.output.on("mousedown",function(){t.mousedown=!0,t.waitingtopin||(t.waspinned=t.scrollplugin.isPinned()),S.ChatMenu.closeMenus(t)}),this.input.on("mousedown",function(){var e=t.menus.get("whisper-messages");e&&e.visible||S.ChatMenu.closeMenus(t)});var i=null,u=!1,r=(0,l.default)(function(){t.scrollplugin.updateAndPin(i),u=!1},300);return e(window).on("resize",function(){u||(i=t.scrollplugin.isPinned(),u=!0),r()}),this.loginscrn.on("click","#chat-btn-login",function(){var e=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");try{if(window.self!==window.top)return void(window.parent.location.href=e+"/login?follow="+encodeURIComponent(window.parent.location.pathname))}catch(e){}window.location.href=e+"/login?follow="+encodeURIComponent(window.location.pathname),t.loginscrn.hide()}),this.loginscrn.on("click","#chat-btn-cancel",function(){t.loginscrn.hide()}),this.lines.on("click",".chat-open-whisper",function(s){var i=e(s.target).data("username");return t.whispers.has(i)&&t.menus.get("whisper-users").selectConversation(i),!1}),this.lines.on("click",".chat-remove-whisper",function(s){var i=e(s.target).data("username");if(t.whispers.has(i)){e.ajax({url:"/profile/messages/"+encodeURIComponent(i)+"/unread",method:"delete"});var n=t.scrollplugin.isPinned();t.whispers.delete(i),t.menus.get("whisper-users").redraw(),e(s.target).closest(".msg-whisper").remove(),t.scrollplugin.updateAndPin(n)}return!1}),e(document).on("keydown",function(e){27===e.keyCode&&S.ChatMenu.closeMenus(t)}),this.scrollplugin.updateAndPin(!0),this.input.attr("disabled",!1),this.input.focus(),this}},{key:"withFormatters",value:function(){return this.formatters.push(new v.HtmlTextFormatter(this)),this.formatters.push(new v.UrlFormatter(this)),this.formatters.push(new v.EmoteFormatter(this)),this.formatters.push(new v.MentionedUserFormatter(this)),this.formatters.push(new v.GreenTextFormatter(this)),this}},{key:"withEmotes",value:function(e){var t=this;return this.emoticons=new Set(e.destiny),this.twitchemotes=new Set(e.twitch),this.emoticons.forEach(function(e){return t.autocomplete.addToBucket(e,1,!0,0)}),this.twitchemotes.forEach(function(e){return t.autocomplete.addToBucket(e,1,!0,0)}),this}},{key:"withHistory",value:function(e){var t=this;return e&&e.length>0&&(this.backlogloading=!0,e.forEach(function(e){return t.source.parseAndDispatch({data:e})}),this.backlogloading=!1,this.push(m.MessageBuilder.uiMessage("<hr/>")),this.scrollplugin.updateAndPin(!0)),this}},{key:"withMessages",value:function(){var t=this;return this.authenticated&&e.ajax({url:"/profile/conversations/unread"}).done(function(e){return e.forEach(function(e){return t.whispers.set(e.username,{nick:e.username,unread:e.unread,messages:[],loaded:!1})})}).always(function(e){return t.menus.get("whisper-users").redraw()}),this}},{key:"connect",value:function(e){return this.uri=e,this.source.connect(e),this}},{key:"saveSettings",value:function(){this.authenticated&&this.settings.get("profilesettings")?e.ajax({url:"/chat/settings",method:"post",data:JSON.stringify([].concat(n(this.settings)))}):F.default.write("chat.settings",this.settings)}},{key:"commitSettings",value:function(){var e=this;this.debouncedsave||(this.debouncedsave=(0,l.default)(function(){return e.saveSettings()},1e3,!1)),this.debouncedsave()}},{key:"applySettings",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&this.saveSettings(),this.updateHighlightRegex(),this.updateIgnoreRegex(),this.updateSettingsCss()}},{key:"sendCommand",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=(t||"").match(/([^ ]+)/g);this.control.emit(e,s||[])}},{key:"addUser",value:function(e){var s=this.users.get(e.nick);return s?e.hasOwnProperty("features")&&!t.isArraysEqual(e.features,s.features)&&(s.features=e.features):(s=new E.default(e),this.users.set(s.nick,s)),s}},{key:"onDISPATCH",value:function(e){var t=this,s=e.data;"object"===(void 0===s?"undefined":r(s))&&(s.hasOwnProperty("nick")&&this.autocomplete.updateNick(this.addUser(s).nick),s.hasOwnProperty("users")&&s.users.forEach(function(e){t.autocomplete.updateNick(t.addUser(e).nick)}))}},{key:"onCLOSE",value:function(){var e=this,t=this.connected;if(this.connected=!1,this.reconnect){var s=t?Math.floor(2500*Math.random())+501:Math.floor(25001*Math.random())+5e3;setTimeout(function(){e.connected||e.connect(e.uri)},s),this.push(m.MessageBuilder.statusMessage("Disconnected... reconnecting in "+Math.round(s/1e3)+" seconds"))}}},{key:"onCONNECTING",value:function(){this.push(m.MessageBuilder.statusMessage("Connecting..."))}},{key:"onNAMES",value:function(e){this.push(m.MessageBuilder.statusMessage("Connected. Server connections: "+e.connectioncount)),this.showstarthint&&(this.cmdHINT([Math.floor(Math.random()*U.size)]),this.showstarthint=!1)}},{key:"onJOIN",value:function(e){}},{key:"onQUIT",value:function(e){this.users.has(e.nick)&&(delete this.users.delete(e.nick),this.autocomplete.removeNick(e.nick))}},{key:"onMSG",value:function(e){var t=e.data,s=("/me "===t.substring(0,4)?t.substring(4):t).trim();if("/me "===s.substring(0,4)?s=s.substring(4):"//"===s.substring(0,2)&&(s=s.substring(1)),s=s.trim(),(this.emoticons.has(s)||this.twitchemotes.has(s))&&null!==this.lastmessage&&this.lastmessage.message===s)if(this.lastmessage.type===m.MessageTypes.emote){var i=this.scrollplugin.isPinned();this.lastmessage.incEmoteCount(),this.scrollplugin.updateAndPin(i)}else this.lastmessage.ui.remove(),this.push(m.MessageBuilder.emoteMessage(s,e.timestamp,2));else this.resolveMessage(e.nick,s)||this.push(m.MessageBuilder.userMessage(e.data,this.users.get(e.nick),e.timestamp))}},{key:"onMUTE",value:function(e){var t=e.data;this.user.username.toLowerCase()===e.data.toLowerCase()&&(t="You have been"),this.censorMessageByUsername(e.data),this.push(m.MessageBuilder.commandMessage(t+" muted by "+e.nick,e.timestamp))}},{key:"onUNMUTE",value:function(e){var t=e.data;this.user.username.toLowerCase()===e.data.toLowerCase()&&(t="You have been"),this.push(m.MessageBuilder.commandMessage(t+" unmuted by "+e.nick,e.timestamp))}},{key:"onBAN",value:function(e){var t=e.data;this.user.username.toLowerCase()===t.toLowerCase()&&(t="You have been"),this.censorMessageByUsername(e.data),this.push(m.MessageBuilder.commandMessage(t+" banned by "+e.nick,e.timestamp))}},{key:"onUNBAN",value:function(e){var t=e.data;this.user.username.toLowerCase()===e.data.toLowerCase()&&(t="You have been"),this.push(m.MessageBuilder.commandMessage(t+" unbanned by "+e.nick,e.timestamp))}},{key:"onERR",value:function(e){this.reconnect="toomanyconnections"!==e&&"banned"!==e;var t=k.has(e)?k.get(e):e,s=this.menus.get("whisper-messages");s&&s.visible?s.error(t):this.push(m.MessageBuilder.errorMessage(t))}},{key:"onSUBONLY",value:function(e){var t="on"===e.data?"enabled":"disabled";this.push(m.MessageBuilder.commandMessage("Subscriber only mode "+t+" by "+e.nick,e.timestamp))}},{key:"onBROADCAST",value:function(e){this.push(m.MessageBuilder.broadcastMessage(e.data,e.timestamp))}},{key:"cmdSEND",value:function(e){if(""!==e){var t="/me "===e.substring(0,4).toLowerCase(),s="/"===e.substring(0,1)&&"//"!==e.substring(0,2),i=this.menus.get("whisper-messages");if(s&&i&&i.visible&&S.ChatMenu.closeMenus(this),i&&i.visible)return void this.cmdWHISPER([i.username,e]);if(!t&&s){var n=e.split(" ",1)[0];this.sendCommand(n.substring(1).toUpperCase(),e.substring(n.length+1))}else{var u=(t?e.substring(4):e).trim();if(!this.emoticons.has(u)&&!this.twitchemotes.has(u)&&this.connected){var r=m.MessageBuilder.userMessage(e,this.user);this.push(r),this.unresolved.unshift(r)}this.source.send("MSG",{data:e})}this.inputhistory.add(e),this.autocomplete.markLastComplete()}}},{key:"cmdEMOTES",value:function(){this.push(m.MessageBuilder.infoMessage("Available emoticons: "+this.emoticons.join(", ")+" (www.destiny.gg/emotes)"))}},{key:"cmdHELP",value:function(){var e="Available commands: ";[].concat(n(H)).forEach(function(t){var s=""!==t[1]?"("+t[1]+")":"";e+="/"+t[0]+" "+s+" "}),this.push(m.MessageBuilder.infoMessage(e))}},{key:"cmdHINT",value:function(e){var t=[].concat(n(U)),s=e&&e[0]?parseInt(e[0])-1:-1;s>0&&s<U.size?this.push(m.MessageBuilder.infoMessage(t[s][1])):(void 0===this.lasthintindex||this.lasthintindex===t.length-1?this.lasthintindex=0:this.lasthintindex++,this.push(m.MessageBuilder.infoMessage(t[this.lasthintindex][1])))}},{key:"cmdIGNORE",value:function(e){var t=e[0]||null;t?L.test(t)?(this.ignoreNick(t,!0),this.removeMessageByUsername(t),this.push(m.MessageBuilder.statusMessage("Ignoring "+t))):this.push(m.MessageBuilder.infoMessage("Invalid nick - /ignore nick")):this.ignoring.size<=0?this.push(m.MessageBuilder.infoMessage("Your ignore list is empty")):this.push(m.MessageBuilder.infoMessage("Ignoring the following people: "+Array.from(this.ignoring.values()).join(", ")))}},{key:"cmdUNIGNORE",value:function(e){var t=e[0]||null;t&&L.test(t)?(this.ignoreNick(t,!1),this.push(m.MessageBuilder.statusMessage(t+" has been removed from your ignore list"))):this.push(m.MessageBuilder.errorMessage("Invalid nick - /ignore nick"))}},{key:"cmdMUTE",value:function(e){if(e[0])if(L.test(e[0])){var s=e[1]?t.parseTimeInterval(e[1]):null;s&&s>0?this.source.send("MUTE",{data:e[0],duration:s}):this.source.send("MUTE",{data:e[0]})}else this.push(m.MessageBuilder.infoMessage("Invalid nick - /mute nick[ time]"));else this.push(m.MessageBuilder.infoMessage("Usage: /mute nick[ time]"))}},{key:"cmdBAN",value:function(e,s){if(e.length<3)this.push(m.MessageBuilder.infoMessage("Usage: /"+s+" nick time reason (time can be 'permanent')"));else if(L.test(e[0]))if(e[2]){var i={nick:e[0],reason:e.slice(2,e.length).join(" ")};"IPBAN"===s||/^perm/i.test(e[1])?i.ispermanent="IPBAN"===s||/^perm/i.test(e[1]):i.duration=t.parseTimeInterval(e[1]),this.source.send("BAN",i)}else this.push(m.MessageBuilder.errorMessage("Providing a reason is mandatory"));else this.push(m.MessageBuilder.infoMessage("Invalid nick"))}},{key:"cmdUNBAN",value:function(e,t){e[0]?L.test(e[0])?this.source.send(t,{data:e[0]}):this.push(m.MessageBuilder.infoMessage("Invalid nick - /"+t+" nick")):this.push(m.MessageBuilder.infoMessage("Usage: /"+t+" nick"))}},{key:"cmdSUBONLY",value:function(e,t){"on"!==e[0]&&"off"!==e[0]?this.push(m.MessageBuilder.errorMessage("Invalid argument - /"+t+" on/off")):this.source.send(t.toUpperCase(),{data:e[0]})}},{key:"cmdMAXLINES",value:function(e,t){if(e[0]){var s=Math.abs(parseInt(e[0],10));s?(this.settings.set("maxlines",s),this.applySettings(),this.push(m.MessageBuilder.infoMessage("Current number of lines shown: "+this.settings.get("maxlines")))):this.push(m.MessageBuilder.infoMessage("Invalid argument - /"+t+" is expecting a number"))}else this.push(m.MessageBuilder.infoMessage("Maximum lines stored: "+this.settings.get("maxlines")))}},{key:"cmdTOGGLEHIGHLIGHT",value:function(e,t){var s=this.settings.get("highlightnicks");if(e[0])if(L.test(e[1])){var i=e[0].toLowerCase(),n=s.indexOf(i);switch(t){case"UNHIGHLIGHT":-1!==n&&s.splice(n,1),this.push(m.MessageBuilder.infoMessage("No longer highlighting "+i));break;default:case"HIGHLIGHT":-1===n&&s.push(i),this.push(m.MessageBuilder.infoMessage("Highlighting "+i))}this.settings.set("highlightnicks",s),this.applySettings()}else this.push(m.MessageBuilder.errorMessage("Invalid nick - /"+t+" nick"));else s.length>0?this.push(m.MessageBuilder.infoMessage("Currently highlighted users: "+s.join(", "))):this.push(m.MessageBuilder.infoMessage("No highlighted users"))}},{key:"cmdTIMESTAMPFORMAT",value:function(e){if(e[0]){var t=e.slice(1,e.length);/^[a-z :.,-\\*]+$/i.test(t)?(this.settings.set("timestampformat",t),this.applySettings(),this.push(m.MessageBuilder.infoMessage("New format: "+this.settings.get("timestampformat")))):this.push(m.MessageBuilder.errorMessage("Invalid format, see: http://momentjs.com/docs/#/displaying/format/"))}else this.push(m.MessageBuilder.infoMessage("Current format: "+this.settings.get("timestampformat")+" (the default is 'HH:mm', for more info: http://momentjs.com/docs/#/displaying/format/)"))}},{key:"cmdBROADCAST",value:function(e){this.source.send("BROADCAST",{data:e.join(" ")})}},{key:"onPRIVMSGSENT",value:function(){var e=this.menus.get("whisper-messages");e&&e.visible||this.push(m.MessageBuilder.infoMessage("Your message has been sent."))}},{key:"onPRIVMSG",value:function(e){if(!this.shouldIgnoreUser(e.nick)){if(this.addWhisper(e.nick,{data:e.data,timestamp:e.timestamp,read:!1,nick:e.nick}),this.settings.get("showhispersinchat")){var s=this.users.has(e.nick)?this.users.get(e.nick):new E.default({nick:e.nick});this.push(m.MessageBuilder.whisperMessage(e.data,s,this.user.username,e.timestamp))}this.settings.get("allowNotifications")&&!this.input.is(":focus")&&t.showNotification(e.nick+" whispered ...",e.data,e.timestamp)}}},{key:"cmdWHISPER",value:function(e){if(e[0]&&L.test(e[0].toLowerCase()))if(e[0].toLowerCase()===this.user.username.toLowerCase())this.push(m.MessageBuilder.errorMessage("Cannot send a message to yourself"));else{var t=e.slice(1,e.length).join(" ");this.whispers.has(e[0])&&this.addWhisper(e[0],{data:t,timestamp:Date.now(),read:!0,nick:this.user.username});var s={nick:e[0],data:t};this.source.send("PRIVMSG",s)}else this.push(m.MessageBuilder.errorMessage("Invalid nick - /msg nick message"))}},{key:"cmdCONNECT",value:function(e){this.reconnect=!1,this.uri=e[0],this.source.disconnect(),this.source.connect(this.uri)}},{key:"cmdSTALK",value:function(t){var s=this;return t[0]&&L.test(t[0].toLowerCase())?this.busystalk?void this.push(m.MessageBuilder.errorMessage("Still busy stalking")):this.nextallowedstalk&&this.nextallowedstalk.isAfter(new Date)?void this.push(m.MessageBuilder.errorMessage("Next allowed stalk "+this.nextallowedstalk.fromNow())):(this.busystalk=!0,this.push(m.MessageBuilder.infoMessage("Getting messages for "+[t[0]]+" ...")),void e.ajax({timeout:5e3,url:"/chat/api/v1/"+encodeURIComponent(t[0])+"/stalk"}).always(function(){s.nextallowedstalk=(0,c.default)().add(10,"seconds"),s.busystalk=!1}).done(function(e){if(0===e.lines.length)s.push(m.MessageBuilder.infoMessage("No messages for "+t[0]));else{var i=c.default.utc(1e3*e.lines[e.lines.length-1].timestamp).local().format("MMMM Do YYYY, h:mm:ss a");s.push(m.MessageBuilder.uiMessage("Stalked "+t[0]+' ... <a href="https://dgg.overrustlelogs.net/'+t[0]+'" target="_blank">overrustlelogs.net</a><br />last seen '+i,["h-start"])),e.lines.forEach(function(t){var i=m.MessageBuilder.userMessage(t.text,new E.default({nick:e.nick}),1e3*t.timestamp);i.historical=!0,s.push(i)}),s.push(m.MessageBuilder.cssMessage(["h-end"]))}}).fail(function(e){return s.push(m.MessageBuilder.errorMessage("Error stalking "+t[0]+". Try again later"))})):void this.push(m.MessageBuilder.errorMessage("Invalid nick - /stalk <nick>"))}},{key:"cmdMENTIONS",value:function(t){var s=this;return t[0]||(t[0]=this.user.username),t[0]&&L.test(t[0].toLowerCase())?this.busymentions?void this.push(m.MessageBuilder.errorMessage("Still busy getting mentions")):this.nextallowedmentions&&this.nextallowedmentions.isAfter(new Date)?void this.push(m.MessageBuilder.errorMessage("Next allowed mentions "+this.nextallowedmentions.fromNow())):(this.busymentions=!0,this.push(m.MessageBuilder.infoMessage("Getting mentions for "+[t[0]]+" ...")),void e.ajax({timeout:5e3,url:"/chat/api/v1/"+encodeURIComponent(t[0])+"/mentions"}).always(function(){s.nextallowedmentions=(0,c.default)().add(10,"seconds"),s.busymentions=!1}).done(function(e){if(0===e.length)s.push(m.MessageBuilder.infoMessage("No mentions for "+t[0]));else{var i=c.default.utc(1e3*e[e.length-1].date).local().format("MMMM Do YYYY, h:mm:ss a");s.push(m.MessageBuilder.uiMessage("Mentions for "+t[0]+' ... <a href="https://dgg.overrustlelogs.net/'+t[0]+'" target="_blank">overrustlelogs.net</a><br /> last message '+i,["h-start"])),e.forEach(function(e){var t=m.MessageBuilder.userMessage(e.text,new E.default({nick:e.nick}),1e3*e.date);t.historical=!0,s.push(t)}),s.push(m.MessageBuilder.cssMessage(["h-end"]))}}).fail(function(e){return s.push(m.MessageBuilder.errorMessage("Error retrieving "+t[0]+" mentions. Try again later"))})):void this.push(m.MessageBuilder.errorMessage("Invalid nick - /mentions <nick>"))}},{key:"cmdTAG",value:function(e){if(!e[0])return void this.push(m.MessageBuilder.infoMessage("Tagged nicks: "+[].concat(n(this.taggednicks)).map(function(e){return e[0]}).join(", ")+". Available colors: "+b.join(", ")));if(!e[0]||!L.test(e[0]))return void this.push(m.MessageBuilder.errorMessage("Invalid nick - /tag <nick> <color>"));var t=e[0].toLowerCase();if(t===this.user.username.toLowerCase())return void this.push(m.MessageBuilder.errorMessage("Cannot tag yourself"));var s=e[1]&&-1!==b.indexOf(e[1])?e[1]:[].concat(b)[Math.floor(Math.random()*b.size)];this.taggednicks.set(t,s),this.settings.set("taggednicks",[].concat(n(this.taggednicks))),this.applySettings(),this.push(m.MessageBuilder.infoMessage("Tagged "+e[0]+" AYYYLMAO with "+s))}},{key:"cmdUNTAG",value:function(e){if(!e[0])return void this.push(m.MessageBuilder.infoMessage("Tagged nicks: "+[].concat(n(this.taggednicks)).join(",")));if(!e[0]||!L.test(e[0]))return void this.push(m.MessageBuilder.errorMessage("Invalid nick - /untag <nick>"));var t=e[0].toLowerCase();this.taggednicks.delete(t),this.settings.set("taggednicks",[].concat(n(this.taggednicks))),this.applySettings(),this.push(m.MessageBuilder.infoMessage("Un-tagged "+e[0]+" "))}},{key:"push",value:function(e){if(e.type!==m.MessageTypes.user||!this.shouldIgnoreMessage(e.message)){var s=this.settings.get("maxlines"),i=this.lines.children(),n=this.scrollplugin.isPinned()&&!this.mousedown&&!this.waitingtopin;if(n&&i.length>=s&&i.slice(0,i.length-s).remove(),this.lastmessage&&this.lastmessage.type===m.MessageTypes.emote&&this.lastmessage.emotecount>1&&this.lastmessage.completeCombo(),e.type===m.MessageTypes.user){var u=e.user.nick.toLowerCase();this.taggednicks.has(u)&&(e.tag=this.taggednicks.get(u))}return e.highlighted=this.settings.get("highlight")&&e.type===m.MessageTypes.user&&!e.user.hasFeature(D.default.BOT)&&e.user.username!==this.user.username&&null!==this.highlightregex&&Boolean(this.highlightregex.test(e.message)||this.highlightregex.test(e.username)),this.lines.append(e.attach(this)),this.backlogloading||(this.scrollplugin.updateAndPin(n),e.highlighted&&this.settings.get("allowNotifications")&&!this.input.is(":focus")&&t.showNotification(e.user.username+" said ...",e.message,e.timestamp.valueOf())),this.lastmessage=e,e}}},{key:"resolveMessage",value:function(e,t){var s=!0,i=!1,n=void 0;try{for(var u,r=this.unresolved[Symbol.iterator]();!(s=(u=r.next()).done);s=!0){var o=u.value;if(this.user.username===e&&o.message===t)return this.unresolved.splice(this.unresolved.indexOf(o),1),!0}}catch(e){i=!0,n=e}finally{try{!s&&r.return&&r.return()}finally{if(i)throw n}}return!1}},{key:"censorMessageByUsername",value:function(e){var t=this.lines.children('div[data-username="'+e.toLowerCase()+'"]');this.settings.get("showremoved")?t.addClass("censored"):t.remove(),this.scrollplugin.reset()}},{key:"removeMessageByUsername",value:function(e){this.lines.children('div[data-username="'+e.toLowerCase()+'"]').remove(),this.scrollplugin.reset()}},{key:"ignoreNick",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=e.toLowerCase(),t?this.ignoring.has(e)&&this.ignoring.delete(e):this.ignoring.add(e),this.settings.set("ignorenicks",[].concat(n(this.ignoring))),this.applySettings()}},{key:"shouldIgnoreMessage",value:function(e){return""!==e&&this.ignoreregex&&this.ignoreregex.test(e)}},{key:"shouldIgnoreUser",value:function(e){return this.ignoring.has(e.toLowerCase())}},{key:"addWhisper",value:function(e,t){var s=this.whispers.get(e)||{nick:e,unread:0,messages:[],loaded:!0};this.whispers.set(e,s),t.read||s.unread++,s.loaded&&s.messages.push(t),this.menus.get("whisper-messages").redraw(),this.menus.get("whisper-users").redraw()}},{key:"updateSettingsCss",value:function(){var e=this;Array.from(this.settings.keys()).filter(function(t){return"boolean"==typeof e.settings.get(t)}).forEach(function(t){return e.ui.toggleClass("pref-"+t,e.settings.get(t))})}},{key:"updateIgnoreRegex",value:function(){var e=Array.from(this.ignoring.values()).map(t.makeSafeForRegex);this.ignoreregex=e.length>0?new RegExp("\\b(?:"+e.join("|")+")\\b","i"):null}},{key:"updateHighlightRegex",value:function(){var e=[].concat(n(this.settings.get("highlightnicks"))),t=[].concat(n(this.settings.get("customhighlight")));e.push(this.user.username);var s=[].concat(n(e),n(t)).filter(function(e){return""!==e});this.highlightregex=s.length>0?new RegExp("\\b(?:"+s.join("|")+")\\b","i"):null}}],[{key:"isArraysEqual",value:function(e,t){return(!e||!t)&&(e.length!==t.length||e.sort().toString()!==t.sort().toString())}},{key:"showNotification",value:function(e,t,s){if("granted"===Notification.permission){var i=new Notification(e,{body:t,tag:"dgg"+s,icon:"/notifyicon.png",dir:"auto"});setTimeout(function(){return i.close()},5e3),i.onclick=function(){}}}},{key:"makeSafeForRegex",value:function(e){return e.trim().replace(/[\-\[\]\/{}()*+?.\\\^$|]/g,"\\$&")}},{key:"parseTimeInterval",value:function(e){var t=0,s={s:1e9,sec:1e9,secs:1e9,second:1e9,seconds:1e9,m:6e10,min:6e10,mins:6e10,minute:6e10,minutes:6e10,h:36e11,hr:36e11,hrs:36e11,hour:36e11,hours:36e11,d:864e11,day:864e11,days:864e11};return e.replace(/(\d+(?:\.\d*)?)([a-z]+)?/gi,function(e,i,n){i*=n?s[n.toLowerCase()]||s.s:s.s,t+=+i}),t}}]),t}();t.default=G}).call(t,s(4))},62:function(e,t,s){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}();s(133);var u=function(){function t(s){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{sliderMinHeight:40,tabIndex:1};i(this,t),this.scroller=e(s).nanoScroller(Object.assign({disableResize:!0,preventPageScrolling:!0},n))[0].nanoscroller}return n(t,[{key:"isPinned",value:function(){return!this.scroller.isActive||this.scroller.contentScrollTop>=this.scroller.maxScrollTop-30}},{key:"updateAndPin",value:function(e){this.reset(),e&&this.scroller.scrollBottom(0)}},{key:"reset",value:function(){this.scroller.reset()}}]),t}();t.default=u}).call(t,s(4))},63:function(e,t,s){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),r=window.localStorage||{},o=window.JSON,a=function(){function e(){n(this,e)}return u(e,null,[{key:"write",value:function(e,t){var s="";try{s=o.stringify(t instanceof Map||t instanceof Set?[].concat(i(t)):t)}catch(e){console.error(e)}r.setItem(e,s)}},{key:"read",value:function(e){var t=null;try{t=o.parse(r.getItem(e))}catch(e){console.error(e)}return t}},{key:"remove",value:function(e){try{r.removeItem(e)}catch(e){console.error(e)}}}]),e}();t.default=a},67:function(e,t,s){var i=s(115);e.exports=function(e,t,s){function n(){var h=i()-a;h<t&&h>0?u=setTimeout(n,t-h):(u=null,s||(l=e.apply(o,r),u||(o=r=null)))}var u,r,o,a,l;return null==t&&(t=100),function(){o=this,r=arguments,a=i();var h=s&&!u;return u||(u=setTimeout(n,t)),h&&(l=e.apply(o,r),o=r=null),l}}},70:function(e,t){},74:function(e,t){e.exports={destiny:["Dravewin","INFESTINY","FIDGETLOL","Hhhehhehe","GameOfThrows","WORTH","FeedNathan","Abathur","LUL","Heimerdonger","SoSad","DURRSTINY","SURPRISE","NoTears","OverRustle","DuckerZ","Kappa","Klappa","DappaKappa","BibleThump","AngelThump","FrankerZ","BasedGod","OhKrappa","SoDoge","WhoahDude","MotherFuckinGame","DaFeels","UWOTM8","CallCatz","CallChad","DatGeoff","Disgustiny","FerretLOL","Sippy","DestiSenpaii","Nappa","DAFUK","AYYYLMAO","DANKMEMES","MLADY","SOTRIGGERED","MASTERB8","NOTMYTEMPO","LIES","LeRuse","YEE","SWEATSTINY","PEPE","CheekerZ","SpookerZ","SLEEPSTINY","PICNIC","Memegasm","WEEWOO","KappaRoss","ASLAN","DJAslan","TRUMPED","BASEDWATM8","BERN","HmmStiny","PepoThink","FeelsAmazingMan","FeelsBadMan","FeelsGoodMan","OhMyDog","Wowee","haHAA","POTATO","NOBULLY"],twitch:["nathanD","nathanDank","nathanF","nathanNotears","nathanPepe","nathanRustle","nathanTowel","nathanWat","nathanThinking","nathanRuse","nathanYee","nathanWeeb"]}},85:function(e,t,s){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),u=s(51),r=function(e){return e&&e.__esModule?e:{default:e}}(u),o=function(){function e(t){var s=this;if(i(this,e),this.minWordLength=1,this.maxResults=10,this.buckets={},this.origVal=null,this.searchResults=[],this.searchIndex=-1,this.searchWord=null,this.input=t.input,!this.input||0===this.input.length||!this.input[0].setSelectionRange)return this;setInterval(this.expireUsers.bind(this),6e4),this.input.on("mousedown",this.resetSearch.bind(this)),this.input.on("keydown",function(e){9===e.which?(e.preventDefault(),e.stopPropagation(),s.searchResults.length<=0&&(s.resetSearch(),s.searchSelectWord(e.shiftKey)),s.showAutoComplete()):s.resetSearch()})}return n(e,[{key:"getBucketId",value:function(e){return 0===e.length?"":e.match(/[\w]/)[0].toLowerCase()}},{key:"addToBucket",value:function(e,t,s,i){var n=this.getBucketId(e);return this.buckets[n]||(this.buckets[n]={}),this.buckets[n][e]||(this.buckets[n][e]={data:e,weight:t,isemote:!!s,promoted:i}),this.buckets[n][e]}},{key:"toggleNick",value:function(e,t){return t?this.removeNick(e):this.updateNick(e)}},{key:"removeNick",value:function(e){var t=this.getBucketId(e);return!(!this.buckets[t]||!this.buckets[t][e])&&(delete this.buckets[t][e],!0)}},{key:"updateNick",value:function(e){var t=Date.now();this.addToBucket(e,t,!1,0).weight=t}},{key:"promoteNick",value:function(e){var t=Date.now(),s=this.addToBucket(e,1,!1,t);if(s.isemote)return this;s.promoted=t}},{key:"getSearchWord",value:function(e,t){var s=e.substring(0,t),i=e.substring(t),n=s.lastIndexOf(" ")+1,u=i.indexOf(" "),r=!1;return n>0&&(s=s.substring(n)),u>-1&&(i=i.substring(0,u)),0===s.lastIndexOf("@")&&(n++,s=s.substring(1),r=!0),{word:s+i,startCaret:n,isUserSearch:r}}},{key:"sortResults",value:function(e,t){return e&&t?e.promoted!==t.promoted?e.promoted>t.promoted?-1:1:e.isemote!==t.isemote?e.isemote&&!t.isemote?-1:1:e.weight!==t.weight?e.weight>t.weight?-1:1:(e=e.data.toLowerCase(),t=t.data.toLowerCase(),e===t?0:e>t?1:-1):0}},{key:"searchBuckets",value:function(e,t,s){e=r.default.makeSafeForRegex(e);var i=[],n=new RegExp("^"+e,"i"),u=this.buckets[this.getBucketId(e)]||{};for(var o in u)!u.hasOwnProperty(o)||s&&u[o].isemote||n.test(o)&&i.push(u[o]);return i.sort(this.sortResults),i.slice(0,t)}},{key:"expireUsers",value:function(){var e=Date.now()-6e5;for(var t in this.buckets)if(this.buckets.hasOwnProperty(t))for(var s in this.buckets[t])if(this.buckets[t].hasOwnProperty(s)){var i=this.buckets[t][s];!i.isemote&&i.promoted<=e&&(i.promoted=0),!i.isemote&&i.weight<=e&&(i.weight=1)}}},{key:"markLastComplete",value:function(){if(this.lastComplete){var e=this.buckets[this.getBucketId(this.lastComplete)]||{};if(!e[this.lastComplete])return this.lastComplete=null;if(e[this.lastComplete].isemote){for(var t in e)e.hasOwnProperty(t)&&(e[t].promoted=0);return this.lastComplete=null}this.promoteNick(this.lastComplete),this.lastComplete=null}}},{key:"resetSearch",value:function(){this.origVal=null,this.searchResults=[],this.searchIndex=-1,this.searchWord=null}},{key:"searchSelectWord",value:function(e){var t=this.getSearchWord(this.input.val(),this.input[0].selectionStart);if(t.word.length>=this.minWordLength){this.searchWord=t;var s=!!e||this.searchWord.isUserSearch;this.searchResults=this.searchBuckets(this.searchWord.word,this.maxResults,s),this.origVal=this.input.val().toString()}}},{key:"showAutoComplete",value:function(){this.searchIndex=this.searchIndex>=this.searchResults.length-1?0:this.searchIndex+1;var e=this.searchResults[this.searchIndex];if(e&&e.data!==this.searchWord.word){this.lastComplete=e.data;var t=this.origVal.substr(0,this.searchWord.startCaret),s=this.origVal.substr(this.searchWord.startCaret+this.searchWord.word.length);" "===s[0]&&0!==s.length||(s=" "+s),this.input.focus().val(t+e.data+s),this.input[0].setSelectionRange(t.length+e.data.length+1,t.length+e.data.length+1)}}}]),e}();t.default=o},86:function(e,t,s){"use strict";(function(e){function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),n=function(){function t(e,i){var n=this;s(this,t),this.chat=e,this.css=i,this.focused=[],this.chat.lines.on("mousedown",function(e){return n.toggleElement(e.target)})}return i(t,[{key:"toggleElement",value:function(t){var s=e(t);s.hasClass("chat-user")?this.toggleFocus(s.closest(".msg-user").data("username"),!0).toggleFocus(s.text().toLowerCase()):s.hasClass("user")?this.toggleFocus(s.closest(".msg-user").data("username")):this.focused.length>0&&this.clearFocus()}},{key:"addCssRule",value:function(e){this.css.insertRule('.msg-user[data-username="'+e+'"]{opacity:1 !important;}',this.focused.length),this.focused.push(e),this.redraw()}},{key:"removeCssRule",value:function(e){this.css.deleteRule(e),this.focused.splice(e,1),this.redraw()}},{key:"clearFocus",value:function(){var e=this;this.focused.forEach(function(t){return e.css.deleteRule(0)}),this.focused=[],this.redraw()}},{key:"redraw",value:function(){this.chat.ui.toggleClass("focus-user",this.focused.length>0)}},{key:"toggleFocus",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.focused.indexOf(e.toLowerCase()),i=-1!==s;return null===t&&(t=!i),t&&!i?this.addCssRule(e):!t&&i&&this.removeCssRule(s),this}}]),t}();t.default=n}).call(t,s(4))},87:function(e,t,s){"use strict";(function(e){function i(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.UrlFormatter=t.MentionedUserFormatter=t.HtmlTextFormatter=t.GreenTextFormatter=t.EmoteFormatter=t.ChatFormatter=void 0;var o=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),a=s(29),l=function(e){return e&&e.__esModule?e:{default:e}}(a),h=s(132),c="(?:"+h.join("|")+")",d=document.createElement("div"),f=function(){function e(t){r(this,e),this.chat=t}return o(e,[{key:"format",value:function(e,t){return e}}]),e}(),g=function(e){function t(){return r(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return u(t,e),o(t,[{key:"format",value:function(e){return d.textContent=e,d.innerHTML}}]),t}(f),A=void 0,p=void 0,E=function(e){function t(e){r(this,t);var s=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),u=[].concat(i(e.emoticons)).join("|"),o=[].concat(i(e.twitchemotes)).join("|");return A=new RegExp("(^|\\s)("+u+")(?=$|\\s)","gm"),p=new RegExp("(^|\\s)("+u+"|"+o+")(?=$|\\s)","gm"),s}return u(t,e),o(t,[{key:"format",value:function(e,t){var s=void 0;return s=t?t.hasFeature(l.default.SUBSCRIBERT0)?p:A:p,e.replace(s,'$1<div title="$2" class="chat-emote chat-emote-$2">$2 </div>')}}]),t}(f),m=function(e){function t(){return r(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),o(t,[{key:"format",value:function(e,t){return t&&0===e.indexOf("&gt;")&&t.hasAnyFeatures(l.default.SUBSCRIBERT3,l.default.SUBSCRIBERT4,l.default.SUBSCRIBERT2,l.default.ADMIN,l.default.MODERATOR)&&(e='<span class="greentext">'+e+"</span>"),e}}]),t}(f),S=function(e){function t(e){r(this,t);var s=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.userregex=/((?:^|\s)@?)([a-zA-Z0-9_]{3,20})(?=$|\s|[\.\?!,])/g,s}return u(t,e),o(t,[{key:"format",value:function(e,t){var s=this;return e.replace(this.userregex,function(e,t,i){return s.chat.users.has(i)?t+'<span class="chat-user">'+i+"</span>":e})}}]),t}(f),v=function(t){function s(t){r(this,s);var i=n(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,t)),u={"p{L}":"\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC","p{N}":"\\u0030-\\u0039\\u00B2\\u00B3\\u00B9\\u00BC-\\u00BE\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u09F4-\\u09F9\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0B72-\\u0B77\\u0BE6-\\u0BF2\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0CE6-\\u0CEF\\u0D66-\\u0D75\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F33\\u1040-\\u1049\\u1090-\\u1099\\u1369-\\u137C\\u16EE-\\u16F0\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19DA\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u2150-\\u2182\\u2185-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2CFD\\u3007\\u3021-\\u3029\\u3038-\\u303A\\u3192-\\u3195\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\uA620-\\uA629\\uA6E6-\\uA6EF\\uA830-\\uA835\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19","p{Sc}":"\\u0024\\u00A2-\\u00A5\\u058F\\u060B\\u09F2\\u09F3\\u09FB\\u0AF1\\u0BF9\\u0E3F\\u17DB\\u20A0-\\u20B9\\uA838\\uFDFC\\uFE69\\uFF04\\uFFE0\\uFFE1\\uFFE5\\uFFE6","p{Sk}":"\\u005E\\u0060\\u00A8\\u00AF\\u00B4\\u00B8\\u02C2-\\u02C5\\u02D2-\\u02DF\\u02E5-\\u02EB\\u02ED\\u02EF-\\u02FF\\u0375\\u0384\\u0385\\u1FBD\\u1FBF-\\u1FC1\\u1FCD-\\u1FCF\\u1FDD-\\u1FDF\\u1FED-\\u1FEF\\u1FFD\\u1FFE\\u309B\\u309C\\uA700-\\uA716\\uA720\\uA721\\uA789\\uA78A\\uFBB2-\\uFBC1\\uFF3E\\uFF40\\uFFE3","p{So}":"\\u00A6\\u00A9\\u00AE\\u00B0\\u0482\\u060E\\u060F\\u06DE\\u06E9\\u06FD\\u06FE\\u07F6\\u09FA\\u0B70\\u0BF3-\\u0BF8\\u0BFA\\u0C7F\\u0D79\\u0F01-\\u0F03\\u0F13\\u0F15-\\u0F17\\u0F1A-\\u0F1F\\u0F34\\u0F36\\u0F38\\u0FBE-\\u0FC5\\u0FC7-\\u0FCC\\u0FCE\\u0FCF\\u0FD5-\\u0FD8\\u109E\\u109F\\u1390-\\u1399\\u1940\\u19DE-\\u19FF\\u1B61-\\u1B6A\\u1B74-\\u1B7C\\u2100\\u2101\\u2103-\\u2106\\u2108\\u2109\\u2114\\u2116\\u2117\\u211E-\\u2123\\u2125\\u2127\\u2129\\u212E\\u213A\\u213B\\u214A\\u214C\\u214D\\u214F\\u2195-\\u2199\\u219C-\\u219F\\u21A1\\u21A2\\u21A4\\u21A5\\u21A7-\\u21AD\\u21AF-\\u21CD\\u21D0\\u21D1\\u21D3\\u21D5-\\u21F3\\u2300-\\u2307\\u230C-\\u231F\\u2322-\\u2328\\u232B-\\u237B\\u237D-\\u239A\\u23B4-\\u23DB\\u23E2-\\u23F3\\u2400-\\u2426\\u2440-\\u244A\\u249C-\\u24E9\\u2500-\\u25B6\\u25B8-\\u25C0\\u25C2-\\u25F7\\u2600-\\u266E\\u2670-\\u26FF\\u2701-\\u2767\\u2794-\\u27BF\\u2800-\\u28FF\\u2B00-\\u2B2F\\u2B45\\u2B46\\u2B50-\\u2B59\\u2CE5-\\u2CEA\\u2E80-\\u2E99\\u2E9B-\\u2EF3\\u2F00-\\u2FD5\\u2FF0-\\u2FFB\\u3004\\u3012\\u3013\\u3020\\u3036\\u3037\\u303E\\u303F\\u3190\\u3191\\u3196-\\u319F\\u31C0-\\u31E3\\u3200-\\u321E\\u322A-\\u3247\\u3250\\u3260-\\u327F\\u328A-\\u32B0\\u32C0-\\u32FE\\u3300-\\u33FF\\u4DC0-\\u4DFF\\uA490-\\uA4C6\\uA828-\\uA82B\\uA836\\uA837\\uA839\\uAA77-\\uAA79\\uFDFD\\uFFE4\\uFFE8\\uFFED\\uFFEE\\uFFFC\\uFFFD"},o=u["p{L}"],a=u["p{N}"],l=o+a,h=l+"/\\-+=_&~*%@|#.,:;'?!"+u["p{Sc}"]+u["p{Sk}"]+u["p{So}"],d=l+"/\\-+=_&~*%;"+u["p{Sc}"],f="(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])",g="["+l+"](?:["+l+"\\-]*["+l+"])?",A="(?:"+g+"\\.)+",p="(?:"+A+c+"|(?:\\b"+f+"\\."+f+"\\."+f+"\\."+f+"\\b))",E="\\[["+h+"]*(?:\\[["+h+"]*\\]["+h+"]*)*\\]",m="\\(["+h+"]*(?:\\(["+h+"]*\\)["+h+"]*)*\\)",S=m+"|"+E,v="(?:["+h+"]*(?:"+S+"|["+d+"])+)+",C="(?:"+v+"|/|\\b|$)",O="(?:"+p+"(?::[0-9]+)?/"+C+")|(?:"+p+"(?::[0-9]+)?(?:\\b|$))",T="\\b(https?|ftp|wss?)://"+v,I=T+"|"+O;return i.linkregex=new RegExp(I,"gi"),i._elem=e("<div/>"),i}return u(s,t),o(s,[{key:"encodeUrl",value:function(e){return e.replace(/&/g,"&amp;").replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(/([^\#-~| |!])/g,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}},{key:"format",value:function(e){if(e){var t=this,s="";return/\b(?:NSFL)\b/i.test(e)?s="nsfl-link":/\b(?:NSFW|SPOILER)\b/i.test(e)&&(s="nsfw-link"),e.replace(t.linkregex,function(e,i){i=i?"":"http://";var n=t._elem.html(e).text(),u=n.match(t.linkregex);if(!u)return e;e=t.encodeUrl(u[0]);var r=t.encodeUrl(n.substring(u[0].length));return'<a target="_blank" class="externallink '+s+'" href="'+(i+e)+'" rel="nofollow">'+e+"</a> "+r})}}}]),s}(f);t.ChatFormatter=f,t.EmoteFormatter=E,t.GreenTextFormatter=m,t.HtmlTextFormatter=g,t.MentionedUserFormatter=S,t.UrlFormatter=v}).call(t,s(4))},88:function(e,t,s){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),u=s(63),r=function(e){return e&&e.__esModule?e:{default:e}}(u),o=function(){function t(s){var n=this;i(this,t),this.input=e(s.input),this.history=r.default.read("chat.history")||[],this.index=-1,this.lastinput="",this.maxentries=20,this.input.on("keydown",function(e){e.shiftKey||e.metaKey||e.ctrlKey||38!==e.which&&40!==e.which?n.index=-1:n.show(38===e.which?-1:1)})}return n(t,[{key:"show",value:function(e){if(this.index<0){if(-1!==e)return;if(this.index=this.history.length,this.lastinput=this.input.val(),this.index<=0)return}var t=this.index+e;if(t>=this.history.length||t<0)return void(t>=this.history.length&&(this.input.val(this.lastinput),this.index=-1));this.index=t,this.input.val(this.history[t])}},{key:"add",value:function(e){this.index=-1,this.history.length>0&&this.history[this.history.length-1]===e||(this.history.push(e),this.history.length>this.maxentries&&this.history.shift(),r.default.write("chat.history",this.history))}}]),t}();t.default=o}).call(t,s(4))},89:function(e,t,s){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function n(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ChatWhisperMessages=t.ChatWhisperUsers=t.ChatEmoteMenu=t.ChatUserMenu=t.ChatSettingsMenu=t.ChatMenu=void 0;var a=function e(t,s,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,s);if(void 0===n){var u=Object.getPrototypeOf(t);return null===u?void 0:e(u,s,i)}if("value"in n)return n.value;var r=n.get;if(void 0!==r)return r.call(i)},l=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),h=s(62),c=i(h),d=s(29),f=i(d),g=s(42),A=i(g),p=s(0),E=i(p),m=s(67),S=(i(m),function(e){function t(e,s,i){u(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.ui=e,n.btn=s,n.chat=i,n.visible=!1,n.shown=!1,n.ui.find(".scrollable").get().forEach(function(e){return n.scrollplugin=new c.default(e)}),n.ui.on("click",".close",n.hide.bind(n)),n.btn.on("click",function(e){return n.toggle()}),n}return o(t,e),l(t,[{key:"show",value:function(){this.visible||(this.visible=!0,this.shown=!0,this.btn.addClass("active"),this.ui.addClass("active"),this.redraw(),this.emit("show"))}},{key:"hide",value:function(){this.visible&&(this.visible=!1,this.btn.removeClass("active"),this.ui.removeClass("active"),this.emit("hide"))}},{key:"toggle",value:function(){var e=this.visible;t.closeMenus(this.chat),e||this.show()}},{key:"redraw",value:function(){this.visible&&this.scrollplugin&&this.scrollplugin.reset()}}],[{key:"closeMenus",value:function(e){e.menus.forEach(function(e){return e.hide()})}}]),t}(A.default)),v=function(t){function s(e,t,i){u(this,s);var n=r(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,e,t,i));return n.notificationEl=n.ui.find("#chat-settings-notification-permissions"),n.customHighlightEl=n.ui.find("input[name=customhighlight]"),n.allowNotificationsEl=n.ui.find('input[name="allowNotifications"]'),n.customHighlightEl.on("keypress blur",function(e){return n.onCustomHighlightChange(e)}),n.ui.on("change",'input[type="checkbox"]',function(e){return n.onSettingsChange(e)}),n}return o(s,t),l(s,[{key:"onCustomHighlightChange",value:function(t){if(!t.which||13===t.which){var s=e(t.target).val().toString().split(",").map(function(e){return e.trim()});this.chat.settings.set("customhighlight",[].concat(n(new Set(s)))),this.chat.commitSettings()}}},{key:"onSettingsChange",value:function(t){var s=this,i=e(t.target).attr("name"),n=e(t.target).is(":checked");switch(i){case"showremoved":case"showtime":case"hideflairicons":case"highlight":case"showhispersinchat":this.chat.settings.set(i,n);break;case"profilesettings":!n&&this.chat.authenticated&&e.ajax({url:"/chat/settings",method:"delete"}),this.chat.settings.set(i,n);break;case"allowNotifications":n?this.notificationPermission().then(function(e){return s.chat.settings.set(i,!0)},function(e){return s.chat.settings.set(i,!1)}):this.chat.settings.set(i,!1)}this.updateNotification(),this.chat.applySettings(!1),this.chat.commitSettings()}},{key:"show",value:function(){var e=this;this.visible||([].concat(n(this.chat.settings)).forEach(function(t){return e.ui.find("input[name="+t[0]+'][type="checkbox"]').prop("checked",e.chat.settings.get(t[0]))}),"granted"!==Notification.permission&&this.allowNotificationsEl.prop("checked",!1),this.customHighlightEl.val(this.chat.settings.get("customhighlight").join(",")),this.updateNotification()),a(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"show",this).call(this)}},{key:"updateNotification",value:function(){var e="default"===Notification.permission?"required":Notification.permission;this.notificationEl.text("(Permission "+e+")")}},{key:"notificationPermission",value:function(){return new Promise(function(e,t){switch(Notification.permission){case"default":Notification.requestPermission(function(s){switch(s){case"granted":e(s);break;default:t(s)}});break;case"granted":e(Notification.permission);break;case"denied":default:t(Notification.permission)}})}}]),s}(S),C=function(t){function s(t,i,n){u(this,s);var o=r(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,t,i,n));return o.header=o.ui.find("h5 span"),o.groupsEl=e("#chat-groups"),o.group1=e('<ul id="chat-group1">'),o.group2=e('<ul id="chat-group2">'),o.group3=e('<ul id="chat-group3">'),o.group4=e('<ul id="chat-group4">'),o.group5=e('<ul id="chat-group5">'),o.groups=[o.group1,o.group2,o.group3,o.group4,o.group5],o.groupsEl.on("click",".user",function(e){return o.chat.userfocus.toggleFocus(e.target.textContent)}),o.chat.source.on("JOIN",function(e){return o.addAndRedraw(e.nick)}),o.chat.source.on("QUIT",function(e){return o.removeAndRedraw(e.nick)}),o.chat.source.on("NAMES",function(e){return o.redraw()}),o}return o(s,t),l(s,[{key:"redraw",value:function(){var e=this;this.visible&&(this.groups.forEach(function(e){return e.detach().children("li").remove()}),this.chat.users.forEach(function(t){var s=t.username;return e.addUser(s)}),this.sort(),this.groupsEl.append(this.groups),this.header.text(this.chat.users.size)),a(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"redraw",this).call(this)}},{key:"addAndRedraw",value:function(e){this.visible&&!this.hasUser(e)&&(this.addUser(e),this.sort(),this.redraw())}},{key:"removeAndRedraw",value:function(e){this.visible&&this.hasUser(e)&&(this.removeUser(e),this.redraw())}},{key:"removeUser",value:function(e){return this.groupsEl.find('.user[data-username="'+e+'"]').parent().remove()}},{key:"addUser",value:function(e){var t=this.chat.users.get(e),s=t.username&&""!==t.username?t.username:"You",i='<li><a data-username="'+t.username+'" class="user '+t.features.join(" ")+'">'+s+"</a></li>";t.hasFeature(f.default.BOT)||t.hasFeature(f.default.BOT2)?this.group5.append(i):t.hasFeature(f.default.ADMIN)||t.hasFeature(f.default.VIP)?this.group1.append(i):t.hasFeature(f.default.BROADCASTER)?this.group2.append(i):t.hasFeature(f.default.SUBSCRIBER)?this.group3.append(i):this.group4.append(i)}},{key:"hasUser",value:function(e){return this.groupsEl.find('.user[data-username="'+e+'"]').length>0}},{key:"sort",value:function(){this.groups.forEach(function(e){e.children(".user").get().sort(function(e,t){return e.getAttribute("data-username").localeCompare(t.getAttribute("data-username"))}).forEach(function(e){return e.parentNode.appendChild(e)})})}}]),s}(S),O=function(t){function s(t,i,o){u(this,s);var a=r(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,t,i,o));return a.input=e(a.chat.input),a.temotes=e("#twitch-emotes"),a.demotes=e("#destiny-emotes"),a.demotes.append([].concat(n(a.chat.emoticons)).map(function(e){return s.buildEmote(e)}).join("")),a.temotes.append([].concat(n(a.chat.twitchemotes)).map(function(e){return s.buildEmote(e)}).join("")),a.ui.on("click",".chat-emote",function(e){return a.selectEmote(e.target.innerText)}),a}return o(s,t),l(s,[{key:"selectEmote",value:function(e){var t=this.input.val().toString().trim();this.input.val(t+(""===t?"":" ")+e+" ").focus()}}],[{key:"buildEmote",value:function(e){return'<div class="emote"><span title="'+e+'" class="chat-emote chat-emote-'+e+'">'+e+"</span></div>"}}]),s}(S),T=function(t){function s(t,i,n){u(this,s);var o=r(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,t,i,n));return o.unread=0,o.empty=e('<span class="empty">No new whispers :(</span>'),o.notif=e('<span id="chat-whisper-notif"></span>'),o.btn.append(o.notif),o.usersEl=t.find("ul:first"),o.usersEl.on("click",".user",function(e){return o.selectConversation(e.target.getAttribute("data-username"))}),o.usersEl.on("click",".remove",function(e){return o.removeConversation(e.target.getAttribute("data-username"))}),o}return o(s,t),l(s,[{key:"removeConversation",value:function(e){this.chat.whispers.delete(e),this.redraw()}},{key:"selectConversation",value:function(e){S.closeMenus(this.chat),this.chat.input.focus();var t=this.chat.menus.get("whisper-messages");t.username=e,t.conv=this.chat.whispers.get(e),t.show(),this.redraw()}},{key:"updateNotification",value:function(){var e=this,t=this.unread;this.unread=[].concat(n(this.chat.whispers.entries())).map(function(e){return parseInt(e[1].unread)}).reduce(function(e,t){return e+t},0),t<this.unread&&(this.btn.addClass("pulse-once"),setTimeout(function(){return e.btn.removeClass("pulse-once")},2e3)),this.notif.text(this.unread),this.notif.toggle(this.unread>0);try{var s=window.parent.document.title.replace(/^\([0-9]+\) /,"");window.parent.document.title=this.unread>0?"("+this.unread+") "+s:""+s}catch(e){console.error(e)}}},{key:"redraw",value:function(){var e=this;this.updateNotification(),this.visible&&(this.usersEl.empty(),0===this.chat.whispers.size?this.usersEl.append(this.empty):[].concat(n(this.chat.whispers.entries())).sort(function(e,t){return 0===e[1].unread?1:0===t[1].unread?-1:e[1]===t[1]?0:void 0}).forEach(function(t){return e.addConversation(t[0],t[1].unread)})),a(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"redraw",this).call(this)}},{key:"addConversation",value:function(e,t){this.usersEl.append('\n            <li class="conversation unread-'+t+'">\n                <a data-username="'+e+'" title="Hide" class="fa fa-times remove"></a>\n                <a data-username="'+e+'" class="user">'+e+' <span class="badge">'+t+"</span></a>\n            </li>\n        ")}}]),s}(S),I=function(t){function s(t,i,n){u(this,s);var o=r(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,t,i,n));return o.username="",o.conv=null,o.title=t.find(".toolbar span:first"),o.el=t.find(".content:first"),o.loading=e('<div>\n                <i class="fa fa-circle-o-notch fa-spin fa-fw"></i>\n                <span>Loading...</span>\n             </div>'),o}return o(s,t),l(s,[{key:"error",value:function(e){this.el.append('<div class="label label-danger">'+e+"</div>"),this.scrollplugin.updateAndPin(!0)}},{key:"show",value:function(){this.visible||this.chat.ui.addClass("focus-user"),a(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.visible&&this.chat.ui.removeClass("focus-user"),a(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"hide",this).call(this)}},{key:"fetchMessages",value:function(){return e.ajax({url:"/profile/messages/"+encodeURIComponent(this.username)+"/unread"})}},{key:"redraw",value:function(){var e=this;this.visible&&(this.el.empty(),this.conv.unread=0,this.title.text(this.username),this.conv.loaded?this.conv.messages.forEach(function(t){return e.addMessage(t)}):(this.conv.loaded=!0,this.loading.appendTo(this.el),this.fetchMessages().always(function(){return e.loading.detach()}).done(function(t){t.reverse().forEach(function(t){return e.conv.messages.push({data:t.message,timestamp:t.timestamp,nick:t.from})}),e.conv.messages.forEach(function(t){return e.addMessage(t)})}))),a(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"redraw",this).call(this)}},{key:"addMessage",value:function(e){var t=e.data,s=E.default.utc(e.timestamp).local(),i=s.format("MMMM Do YYYY, h:mm:ss a"),n=s.format(this.chat.settings.get("timestampformat")),u=this.chat.user.nick.toLowerCase()===e.nick.toLowerCase();this.chat.formatters.forEach(function(e){return t=e.format(t)}),this.el.append('\n            <div class="msg '+(u?"me":"")+'" title="'+i+" from "+e.nick+'">\n                <div class="tri"></div>\n                <time>'+n+'</time>\n                <div class="text">'+t+"</div>\n            </div>\n        "),this.scrollplugin.updateAndPin(!0)}}]),s}(S);t.ChatMenu=S,t.ChatSettingsMenu=v,t.ChatUserMenu=C,t.ChatEmoteMenu=O,t.ChatWhisperUsers=T,t.ChatWhisperMessages=I}).call(t,s(4))},90:function(e,t,s){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.MessageTypes=t.ChatEmoteMessage=t.ChatUserMessage=t.ChatMessage=t.ChatUIMessage=t.MessageBuilder=void 0;var o=function e(t,s,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,s);if(void 0===n){var u=Object.getPrototypeOf(t);return null===u?void 0:e(u,s,i)}if("value"in n)return n.value;var r=n.get;if(void 0!==r)return r.call(i)},a=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),l=s(29),h=i(l),c=s(0),d=i(c),f={status:"status",error:"error",info:"info",command:"command",broadcast:"broadcast",ui:"ui",chat:"chat",user:"user",emote:"emote"},g=function(){function e(){r(this,e)}return a(e,null,[{key:"cssMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new A("",e)}},{key:"uiMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new A(e,t)}},{key:"statusMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new p(e,t,f.status)}},{key:"errorMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new p(e,t,f.error)}},{key:"infoMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new p(e,t,f.info)}},{key:"broadcastMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new p(e,t,f.broadcast)}},{key:"commandMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new p(e,t,f.command)}},{key:"userMessage",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new E(e,t,s)}},{key:"whisperMessage",value:function(e,t,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=new E(e,t,i);return n.target=s,n}},{key:"emoteMessage",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return new m(e,t,s)}}]),e}(),A=function(){function t(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];r(this,t),this.ui=null,this.chat=null,this.message=e,this.type=f.ui,this.classes=s}return a(t,[{key:"attach",value:function(t){return this.chat=t,this.ui=e(this.html()),this.ui}},{key:"wrap",value:function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.push(this.classes),s.unshift("msg-"+this.type),i.class=s.join(" "),e("<div>",i).html(t)[0].outerHTML}},{key:"html",value:function(){return this.wrap(this.message)}}]),t}(),p=function(e){function t(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.chat;r(this,t);var u=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return u.type=i,u.timestamp=s?d.default.utc(s).local():(0,d.default)(),u}return u(t,e),a(t,[{key:"wrapTime",value:function(){return'<time class="time" title="'+this.timestamp.format("MMMM Do YYYY, h:mm:ss a")+'">'+this.timestamp.format(this.chat.settings.get("timestampformat"))+"</time>"}},{key:"wrapMessage",value:function(){var e=this,t=this.message;return this.chat.formatters.forEach(function(s){return t=s.format(t,e.user)}),'<span class="text">'+t+"</span>"}},{key:"html",value:function(){return this.wrap(this.wrapTime()+" "+this.wrapMessage())}}]),t}(A),E=function(e){function t(e,s){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;r(this,t);var u=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,f.user));return u.user=s,u.highlighted=!1,u.historical=!1,u.target=null,u.tag=null,u.isSlashMe=!1,"/me "===u.message.substring(0,4)?(u.isSlashMe=!0,u.message=u.message.substring(4)):"//"===u.message.substring(0,2)&&(u.message=u.message.substring(1)),u}return u(t,e),a(t,[{key:"wrapTime",value:function(){if(this.historical){return'<time class="time" title="'+this.timestamp.format("MMMM Do YYYY, h:mm:ss a")+'">'+this.timestamp.fromNow()+"</time>"}return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"wrapTime",this).call(this)}},{key:"wrapUser",value:function(e){return(e.features.length>0?'<span class="features">'+this.getFeatureHTML()+"</span>":"")+' <a class="user '+e.features.join(" ")+'">'+e.username+"</a>"}},{key:"html",value:function(){var e=[],t={},s=this.chat.lastmessage&&this.chat.lastmessage.user&&this.user&&this.chat.lastmessage.user.username===this.user.username;if(this.user&&this.user.username&&(t["data-username"]=this.user.username.toLowerCase()),this.chat.user&&this.chat.user.username===this.user.username&&e.push("msg-own"),this.isSlashMe&&e.push("msg-emote"),this.historical&&e.push("msg-historical"),this.highlighted&&e.push("msg-highlight"),s&&!this.target&&e.push("msg-continue"),this.tag&&e.push("msg-tagged msg-tagged-"+this.tag),this.target){e.push("msg-whisper");var i='<a data-username="'+this.user.username+'" class="chat-open-whisper"><i class="fa fa-envelope" aria-hidden="true"></i> open</a> <a data-username="'+this.user.username+'" class="chat-remove-whisper"><i class="fa fa-times" aria-hidden="true"></i> remove</a>';return this.wrap(this.wrapTime()+" "+this.wrapUser(this.user)+" (whispered you) "+i+' <span class="ctrl"></span> '+this.wrapMessage(),e,t)}return this.wrap(this.wrapTime()+" "+this.wrapUser(this.user)+(s?"":":")+' <span class="ctrl"></span> '+this.wrapMessage(),e,t)}},{key:"getFeatureHTML",value:function(){var e="",t=this.user;t.hasFeature(h.default.SUBSCRIBERT4)?e+='<i class="icon-subscribert4" title="Subscriber (T4)"/>':t.hasFeature(h.default.SUBSCRIBERT3)?e+='<i class="icon-subscribert3" title="Subscriber (T3)"/>':t.hasFeature(h.default.SUBSCRIBERT2)?e+='<i class="icon-subscribert2" title="Subscriber (T2)"/>':t.hasFeature(h.default.SUBSCRIBERT1)?e+='<i class="icon-subscriber" title="Subscriber (T1)"/>':!t.hasFeature(h.default.SUBSCRIBERT0)&&t.hasFeature(h.default.SUBSCRIBER)&&(e+='<i class="icon-subscriber" title="Subscriber (T1)"/>');var s=!0,i=!1,n=void 0;try{for(var u,r=t.features[Symbol.iterator]();!(s=(u=r.next()).done);s=!0){switch(u.value){case h.default.SUBSCRIBERT0:e+='<i class="icon-minitwitch" title="Twitch subscriber"/>';break;case h.default.BOT:e+='<i class="icon-bot" title="Bot"/>';break;case h.default.BOT2:e+='<i class="icon-bot2" title="Bot"/>';break;case h.default.NOTABLE:e+='<i class="icon-notable" title="Notable"/>';break;case h.default.TRUSTED:e+='<i class="icon-trusted" title="Trusted"/>';break;case h.default.CONTRIBUTOR:e+='<i class="icon-contributor" title="Contributor"/>';break;case h.default.COMPCHALLENGE:e+='<i class="icon-compchallenge" title="Composition Winner"/>';break;case h.default.EVE:e+='<i class="icon-eve" title="Eve"/>';break;case h.default.SC2:e+='<i class="icon-sc2" title="Starcraft 2"/>';break;case h.default.BROADCASTER:e+='<i class="icon-broadcaster" title="Broadcaster"/>'}}}catch(e){i=!0,n=e}finally{try{!s&&r.return&&r.return()}finally{if(i)throw n}}return e}}]),t}(p),m=function(e){function t(e,s){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;r(this,t);var u=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,s,f.emote));return u.emotecount=i,u.emotecountui=null,u.combocomplete=!1,u}return u(t,e),a(t,[{key:"wrapMessage",value:function(){var e=this.message;return this.chat.formatters.forEach(function(t){return e=t.format(e)}),'<span class="text">'+e+"</span>"}},{key:"getEmoteCountLabel",value:function(){return"<i class='count'>"+this.emotecount+'</i> <i class="x">X</i> <i class="hit">Hits</i> <i class=\'combo\'>C-C-C-COMBO</i> <span class="emotecountbg"></span>'}},{key:"html",value:function(){return this.wrap(this.wrapTime()+" "+this.wrapMessage()+' <span class="emotecount">'+this.getEmoteCountLabel()+"<span>")}},{key:"incEmoteCount",value:function(){++this.emotecount;var e="";this.emotecount>=50?e=" x50":this.emotecount>=30?e=" x30":this.emotecount>=20?e=" x20":this.emotecount>=10?e=" x10":this.emotecount>=5&&(e=" x5"),this.emotecountui||(this.emotecountui=this.ui.find(".emotecount")),this.emotecountui.detach().attr("class","emotecount"+e).html(this.getEmoteCountLabel()).appendTo(this.ui)}},{key:"completeCombo",value:function(){this.emotecountui||(this.emotecountui=this.ui.find(".emotecount")),this.emotecountui.addClass("combo-complete"),this.combocomplete=!0}}]),t}(p);t.MessageBuilder=g,t.ChatUIMessage=A,t.ChatMessage=p,t.ChatUserMessage=E,t.ChatEmoteMessage=m,t.MessageTypes=f}).call(t,s(4))},91:function(e,t,s){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),o=s(42),a=function(e){return e&&e.__esModule?e:{default:e}}(o),l=window.WebSocket||window.MozWebSocket,h=function(e){function t(){i(this,t);var e=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.sock=null,e}return u(t,e),r(t,[{key:"connect",value:function(e){var t=this;try{null!==this.sock&&(this.disconnect(),this.sock=null),this.emit("CONNECTING"),this.sock=new l(e),this.sock.onopen=function(e){return t.emit("OPEN",e)},this.sock.onclose=function(e){return t.emit("CLOSE",e)},this.sock.onerror=function(e){return t.emit("ERR","socketerror")},this.sock.onmessage=function(e){return t.parseAndDispatch(e)}}catch(e){return console.error(e),this.emit("ERR","unknown")}}},{key:"disconnect",value:function(){this.sock&&this.sock.readyState!==this.sock.CLOSED&&this.sock.close()}},{key:"parseAndDispatch",value:function(e){var t=e.data.split(" ",1)[0].toUpperCase(),s=e.data.substring(t.length+1),i=null;try{i=JSON.parse(s)}catch(e){i=s}this.emit("DISPATCH",{data:i,event:t}),this.emit(t,i)}},{key:"send",value:function(e,t){var s="string"==typeof t?t:JSON.stringify(t);console.log(e+" "+s),this.sock.readyState===this.sock.OPEN?this.sock.send(e+" "+s):this.emit("ERR","notconnected")}}]),t}(a.default);t.default=h},92:function(e,t,s){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.nick=t.nick||"",this.username=t.nick||"",this.features=t.features||[]}return n(e,[{key:"hasAnyFeatures",value:function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];var i=!0,n=!1,u=void 0;try{for(var r,o=t[Symbol.iterator]();!(i=(r=o.next()).done);i=!0){var a=r.value;if(-1!==this.features.indexOf(a))return!0}}catch(e){n=!0,u=e}finally{try{!i&&o.return&&o.return()}finally{if(n)throw u}}return!1}},{key:"hasFeature",value:function(e){return this.hasAnyFeatures(e)}}]),e}();t.default=u}},[313]);